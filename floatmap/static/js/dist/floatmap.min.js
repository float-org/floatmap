/*! floatmap 03-05-2015 */
function Rainbow(){"use strict";function a(a){if(a.length<2)throw new Error("Rainbow must have two or more colours.");var f=(d-c)/(a.length-1),g=new ColourGradient;g.setGradient(a[0],a[1]),g.setNumberRange(c,c+f),b=[g];for(var h=1;h<a.length-1;h++){var i=new ColourGradient;i.setGradient(a[h],a[h+1]),i.setNumberRange(c+f*h,c+f*(h+1)),b[h]=i}e=a}var b=null,c=0,d=100,e=["ff0000","ffff00","00ff00","0000ff"];a(e),this.setSpectrum=function(){return a(arguments),this},this.setSpectrumByArray=function(b){return a(b),this},this.colourAt=function(a){if(isNaN(a))throw new TypeError(a+" is not a number");if(1===b.length)return b[0].colourAt(a);var e=(d-c)/b.length,f=Math.min(Math.floor((Math.max(a,c)-c)/e),b.length-1);return b[f].colourAt(a)},this.colorAt=this.colourAt,this.setNumberRange=function(b,f){if(!(f>b))throw new RangeError("maxNumber ("+f+") is not greater than minNumber ("+b+")");return c=b,d=f,a(e),this}}function ColourGradient(){"use strict";function a(a,c,d){var e=a;g>e&&(e=g),e>h&&(e=h);var f=h-g,i=parseInt(c,16),j=parseInt(d,16),k=(j-i)/f,l=Math.round(k*(e-g)+i);return b(l.toString(16))}function b(a){return 1===a.length?"0"+a:a}function c(a){var b=/^#?[0-9a-fA-F]{6}$/i;return b.test(a)}function d(a){if(c(a))return a.substring(a.length-6,a.length);var b=a.toLowerCase();if(i.hasOwnProperty(b))return i[b];throw new Error(a+" is not a valid colour.")}var e="ff0000",f="0000ff",g=0,h=100;this.setGradient=function(a,b){e=d(a),f=d(b)},this.setNumberRange=function(a,b){if(!(b>a))throw new RangeError("maxNumber ("+b+") is not greater than minNumber ("+a+")");g=a,h=b},this.colourAt=function(b){return a(b,e.substring(0,2),f.substring(0,2))+a(b,e.substring(2,4),f.substring(2,4))+a(b,e.substring(4,6),f.substring(4,6))};var i={aliceblue:"F0F8FF",antiquewhite:"FAEBD7",aqua:"00FFFF",aquamarine:"7FFFD4",azure:"F0FFFF",beige:"F5F5DC",bisque:"FFE4C4",black:"000000",blanchedalmond:"FFEBCD",blue:"0000FF",blueviolet:"8A2BE2",brown:"A52A2A",burlywood:"DEB887",cadetblue:"5F9EA0",chartreuse:"7FFF00",chocolate:"D2691E",coral:"FF7F50",cornflowerblue:"6495ED",cornsilk:"FFF8DC",crimson:"DC143C",cyan:"00FFFF",darkblue:"00008B",darkcyan:"008B8B",darkgoldenrod:"B8860B",darkgray:"A9A9A9",darkgreen:"006400",darkgrey:"A9A9A9",darkkhaki:"BDB76B",darkmagenta:"8B008B",darkolivegreen:"556B2F",darkorange:"FF8C00",darkorchid:"9932CC",darkred:"8B0000",darksalmon:"E9967A",darkseagreen:"8FBC8F",darkslateblue:"483D8B",darkslategray:"2F4F4F",darkslategrey:"2F4F4F",darkturquoise:"00CED1",darkviolet:"9400D3",deeppink:"FF1493",deepskyblue:"00BFFF",dimgray:"696969",dimgrey:"696969",dodgerblue:"1E90FF",firebrick:"B22222",floralwhite:"FFFAF0",forestgreen:"228B22",fuchsia:"FF00FF",gainsboro:"DCDCDC",ghostwhite:"F8F8FF",gold:"FFD700",goldenrod:"DAA520",gray:"808080",green:"008000",greenyellow:"ADFF2F",grey:"808080",honeydew:"F0FFF0",hotpink:"FF69B4",indianred:"CD5C5C",indigo:"4B0082",ivory:"FFFFF0",khaki:"F0E68C",lavender:"E6E6FA",lavenderblush:"FFF0F5",lawngreen:"7CFC00",lemonchiffon:"FFFACD",lightblue:"ADD8E6",lightcoral:"F08080",lightcyan:"E0FFFF",lightgoldenrodyellow:"FAFAD2",lightgray:"D3D3D3",lightgreen:"90EE90",lightgrey:"D3D3D3",lightpink:"FFB6C1",lightsalmon:"FFA07A",lightseagreen:"20B2AA",lightskyblue:"87CEFA",lightslategray:"778899",lightslategrey:"778899",lightsteelblue:"B0C4DE",lightyellow:"FFFFE0",lime:"00FF00",limegreen:"32CD32",linen:"FAF0E6",magenta:"FF00FF",maroon:"800000",mediumaquamarine:"66CDAA",mediumblue:"0000CD",mediumorchid:"BA55D3",mediumpurple:"9370DB",mediumseagreen:"3CB371",mediumslateblue:"7B68EE",mediumspringgreen:"00FA9A",mediumturquoise:"48D1CC",mediumvioletred:"C71585",midnightblue:"191970",mintcream:"F5FFFA",mistyrose:"FFE4E1",moccasin:"FFE4B5",navajowhite:"FFDEAD",navy:"000080",oldlace:"FDF5E6",olive:"808000",olivedrab:"6B8E23",orange:"FFA500",orangered:"FF4500",orchid:"DA70D6",palegoldenrod:"EEE8AA",palegreen:"98FB98",paleturquoise:"AFEEEE",palevioletred:"DB7093",papayawhip:"FFEFD5",peachpuff:"FFDAB9",peru:"CD853F",pink:"FFC0CB",plum:"DDA0DD",powderblue:"B0E0E6",purple:"800080",red:"FF0000",rosybrown:"BC8F8F",royalblue:"4169E1",saddlebrown:"8B4513",salmon:"FA8072",sandybrown:"F4A460",seagreen:"2E8B57",seashell:"FFF5EE",sienna:"A0522D",silver:"C0C0C0",skyblue:"87CEEB",slateblue:"6A5ACD",slategray:"708090",slategrey:"708090",snow:"FFFAFA",springgreen:"00FF7F",steelblue:"4682B4",tan:"D2B48C",teal:"008080",thistle:"D8BFD8",tomato:"FF6347",turquoise:"40E0D0",violet:"EE82EE",wheat:"F5DEB3",white:"FFFFFF",whitesmoke:"F5F5F5",yellow:"FFFF00",yellowgreen:"9ACD32"}}(function(){var a,b,c;b=L.GeoModel=Backbone.Model.extend({keepId:!1,set:function(a,b,c){var d,e,f,g;return e=void 0,f=void 0,d=void 0,g=void 0,e=arguments,"object"==typeof a&&(f=a,c=b),f&&f.type&&"Feature"===f.type&&(d=_.clone(f.properties)||{},g=_.clone(f.geometry)||null,g&&(g.coordinates=g.coordinates.slice()),d.geometry=g,f[this.idAttribute]&&(d[this.idAttribute]=f[this.idAttribute]),e=[d,c]),Backbone.Model.prototype.set.apply(this,e)},toJSON:function(a){var b,c,d,e;return b=void 0,e=void 0,c=void 0,a=a||{},b=_.clone(this.attributes),e=_.omit(b,"geometry"),a.cid&&(e.cid=this.cid),c=_.clone(b.geometry)||null,c&&(c.coordinates=c.coordinates.slice()),d={type:"Feature",geometry:c,properties:e},this.keepId&&(d[this.idAttribute]=this.id),d}}),a=L.GeoCollection=Backbone.Collection.extend({model:b,reset:function(a,b){return a&&!_.isArray(a)&&a.features&&(a=a.features),Backbone.Collection.prototype.reset.apply(this,[a,b])},toJSON:function(){var a;return a=Backbone.Collection.prototype.toJSON.apply(this,arguments),{type:"FeatureCollection",features:a}}}),c=Backbone.Model.extend({defaults:{ap:"",ep:"",overall_risk:"Search or right click anywhere on the map to learn more about a region."},url:"/get_queries/"}),$(function(){var b,d,e,f,g,h,i,j,k,l;return j=window.app=window.app||{},k=j.layers=[],j.getPattern=function(a,b){var c;return"ep"===a?null===b?!1:(c="dots ",22>=b?c+="low-mid":b>=23&&33>=b?c+="mid-high":b>=34&&44>=b?c+="high-extreme":b>=45&&55>=b&&(c+="extreme-severe"),c):void 0},j.getColor=function(a,b){var c;return"ap"===a?(c=new Rainbow,c.setSpectrum("#94FFDB","#0003FF"),c.setNumberRange(0,12),"#"+c.colourAt(b)):void 0},j.createSpinner=function(a){var b,c;return b={lines:11,length:4,width:2,radius:7,corners:.9,rotate:0,direction:1,color:"#000",speed:1,trail:60,shadow:!1,hwaccel:!1,className:"spinner",zIndex:2e9,top:"50%",left:"50%"},c=$(a)[0],window.spinner=new Spinner(b).spin(c)},Backbone.Layout.configure({manage:!0}),j.AvgPrecipCollection=a.extend({url:"static/ap/noaa_avg_precip.geojson"}),j.ExtPrecipCollection=a.extend({url:"static/ep/noaa_ex_precip.geojson"}),e=j.HeaderView=Backbone.View.extend({template:"#headerTemplate",getAddress:function(a){var b;return b=new google.maps.Geocoder,b.geocode({address:a},function(a){var b;return b=[a[0].geometry.location.lat(),a[0].geometry.location.lng()],j.layout.views.map.setAddress(b,15)})},events:{"submit #search":function(a){var b;return a.preventDefault(),b=$(a.target).find(".search-input").val(),this.getAddress(b)},"click #tourLink":function(a){var c,d;return a.preventDefault(),c=new b,d=this.insertView("#dataTour",c),d.render()}}}),b=j.DataTourView=Backbone.View.extend({initialize:function(){return window.tour&&window.tour.complete(),window.tour=this.tour=new Shepherd.Tour({defaults:{classes:"shepherd-theme-arrows",scrollTo:!0}})},resetMapAfterTour:function(){return $(".active")&&$(".active").removeClass("active").promise().done(function(){return $(".legend-wrapper").addClass("invisible")}),j.map.setZoom(6),j.map.addLayer(floods,1),$("#floods-switch").prop("checked",!0),j.map.addLayer(ap,2),$("#apLayer-switch").prop("checked",!0),j.map.addLayer(ep,3),$("#epLayer-switch").prop("checked",!0),tour.complete()},resetMapData:function(){var a,b,c,d;for($(".active")&&$(".active").removeClass("active").promise().done(function(){return $(".legend-wrapper").addClass("invisible")}),d=[window.ap,window.ep,window.floods],a=0,c=d.length;c>a;a++)b=d[a],j.map.removeLayer(b);return $("#floods-switch").prop("checked",!1),$("#apLayer-switch").prop("checked",!1),$("#epLayer-switch").prop("checked",!1)},afterRender:function(){return j.map.setZoom(6),this.resetMapData(),$("#welcomeModal").modal("hide"),$("#legend-toggle").trigger("click"),$("#apLayer-switch").trigger("click"),this.tour.addStep("ap-step",{title:"Annual Precipitation",text:"The Annual Precipitation layer shows how total rain and snowfall each year is projected to grow by the 2040-2070 period. More annual precipitation means more water going into rivers, lakes and snowbanks, a key risk factor for bigger floods. These projections come from the National Oceanic and Atmospheric Administration (2014).",attachTo:"#apToggle top",buttons:[{text:"Next",action:function(){return $("#epLayer-switch").trigger("click"),tour.next()}}]}),this.tour.addStep("ep-step",{title:"Storm Frequency",text:"The Storm Frequency layer shows how days with heavy rain or snow (over 1 inch per day) are projected to come more often by the 2040-2070 period. More storm frequency means more rapid surges of water into rivers and lakes, a key risk factor for more frequent flooding. These projections also come from the National Oceanic and Atmospheric Administration (2014).",attachTo:"#stormsToggle top",buttons:[{text:"Next",action:function(){return $("#floods-switch").trigger("click"),tour.next()}}]}),this.tour.addStep("flood-step",{title:"Flood Zones",text:"The Flood Zones show the areas that already are at major risk for flooding, based on where floods have historically reached. If floods become larger and more frequent, many neighboring areas to these historical flood zones are likely to start experience flooding. This information comes from the Federal Emergency Management Administration (2014).",attachTo:"#floodZonesToggle top",buttons:[{text:"Next",action:tour.next}]}),this.tour.addStep("search-step",{title:"Search",text:"Use the search bar to see the risks for a specific location. Try using the search bar now to find a location you care about in the Midwest.",attachTo:".search-input bottom",buttons:[{text:"Next",action:function(){return setTimeout(function(){return tour.next()},450)}}]}),this.tour.addStep("query-step",{title:"Inspect",text:"Right click anywhere on the map to see the numbers for that specific place, or take a tour of some communities at high risk for worsened flooding.",attachTo:"#query left",buttons:[{text:"Take a Tour",action:function(){var a,b;return a=[44.519,-88.019],j.map.setView(a,13),j.map.marker&&j.map.removeLayer(j.map.marker),b=j.map.marker=L.marker(a).addTo(j.map),tour.next()}},{text:"Stop Tour",action:this.resetMapAfterTour}]}),this.tour.addStep("map-lambeau",{title:"Green Bay, WI",text:"The home of the Packers has a large neighborhood of paper plants and homes at high risk of worsened flooding, with storm days increasing nearly 40% and annual precipitation rising 10% in the next few decades.",attachTo:"#legend-toggle top",buttons:[{text:"Continue",action:function(){var a,b;return a=[43.1397,-89.3375],j.map.setView(a,13),j.map.marker&&j.map.removeLayer(j.map.marker),b=j.map.marker=L.marker(a).addTo(j.map),tour.next()}},{text:"Stop Tour",action:this.resetMapAfterTour}]}),this.tour.addStep("map-dane",{title:"Madison, WI Airport",text:"Airports are often built on flat areas near rivers, placing them at serious risk of flooding, like Madison’s main airport, serving 1.6 million passengers per year.",attachTo:"#legend-toggle top",buttons:[{text:"Continue",action:function(){var a,b;return a=[42.732072157891224,-84.50576305389404],j.map.setView([42.73591782230738,-84.48997020721437],13),j.map.marker&&j.map.removeLayer(j.map.marker),b=j.map.marker=L.marker(a).addTo(j.map),tour.next()}},{text:"Stop Tour",action:this.resetMapAfterTour}]}),this.tour.addStep("map-lansing",{title:"Lansing, MI",text:"A large stretch of downtown businesses and homes are at risk of worsened flooding, as well as part of the Michigan State campus.",attachTo:"#legend-toggle top",buttons:[{text:"Continue",action:function(){var a,b;return a=[41.726,-90.31],j.map.setView([41.7348457153312,-90.31],13),j.map.marker&&j.map.removeLayer(j.map.marker),b=j.map.marker=L.marker(a).addTo(j.map),tour.next()}},{text:"Stop Tour",action:this.resetMapAfterTour}]}),this.tour.addStep("map-quadcities",{title:"Quad Cities Nuclear Generating Station",text:"Power plants, including nuclear plants like the one here, are frequently built on riverbanks to use water for cooling. Larger, more frequent future floods could place these power plants and their communities at risk.",attachTo:"#legend-toggle top",buttons:[{text:"Stop Tour",action:this.resetMapAfterTour}]}),this.tour.start()}}),i=j.WelcomeView=Backbone.View.extend({template:"#welcomeTemplate",events:{"click #startDataTour":function(a){var c,d;return a.preventDefault(),c=new b,d=this.insertView("#dataTour",c),d.render()},"shown.bs.modal #welcomeModal":function(){return this.reposition()},"click #closeModal":function(){return j.map.addLayer(floods,1),$("#floods-switch").prop("checked",!0),j.map.addLayer(ap,2),$("#apLayer-switch").prop("checked",!0),j.map.addLayer(ep,3),$("#epLayer-switch").prop("checked",!0)}},initialize:function(){var a;return a=this,$(window).on("resize",function(){return a.reposition()})},afterRender:function(){return $("#welcomeModal").modal({backdrop:"static",keyboard:!0},"show")},reposition:function(){var a,b;return b=this.$el,a=b.find(".modal-dialog"),b.css("display","block"),a.css("margin-top",Math.max(0,($(window).height()-a.height())/2))}}),g=j.MapView=Backbone.View.extend({template:"#mapTemplate",el:!1,setEvents:function(){var a;return a=this,j.map.on("contextmenu",function(a){var b;return console.log(a),$(".legend-wrapper").hasClass("active")||$("#legend-toggle").trigger("click"),b=[a.latlng.lat,a.latlng.lng],j.layout.views.map.setAddress(b,j.map.getZoom())}),j.map.on("zoomstart",function(){return a.previousZoom=j.map.getZoom()}),j.map.on("zoomend",function(){var a;return a=j.map,a.getZoom()<this.previousZoom&&15===this.previousZoom?a.removeLayer(window.marker):void 0})},addLayer:function(a,b){return a.setZIndex(b).addTo(j.map)},setAddress:function(a,b){var c;return j.map.setView(a,b),c=[a[1],a[0]],j.layout.views["#legend"].views["#query"].getQuery(c)},makeGeoJSONLayer:function(a,b){var c,d;return d=this,c="ap"===b?j.layers.apLayer=L.geoJson(a,{renderer:j.map.renderer,style:function(a){return{className:"ap",color:j.getColor("ap",a.properties.DN)}}}):"ep"===b?j.layers.epLayer=L.geoJson(a,{renderer:j.map.renderer,style:function(a){return{className:j.getPattern("ep",a.properties.DN)+" ep"}},filter:function(a){return null===a.properties.DN?!1:!0}}):j.layers[b]=L.geoJson(a,{renderer:j.map.renderer,style:function(){return{className:"no-data-yet"}}})},renderTemplate:function(){var a,b,c,d,e,f,g,h,i,k,l,m,n,o,p;return c="//{s}.tiles.mapbox.com/v3/floatmap.2ce887fe/{z}/{x}/{y}.png",k="//{s}.tiles.mapbox.com/v3/floatmap.2b5f6c80/{z}/{x}/{y}.png",j.map||(o=L.latLng(35.85343961959182,-96.1083984375),n=L.latLng(51.12057809796008,-79.40917968750001),f=L.latLng(44.2205730390537,-88),d=L.latLngBounds(o,n),l=j.map=new L.Map("map",{maxBounds:d,minZoom:5,maxZoom:15,zoom:6,center:f,attributionControl:!1})),l.renderer=L.svg({pane:"tilePane"}).addTo(l),b=window.base=j.layers.base=L.tileLayer(c,{pane:"tilePane"}),h=window.floods=j.layers.floods=L.tileLayer("/static/nfhl_tiles/{z}/{x}/{y}.png",{pane:"tilePane",errorTileUrl:"http://i.imgur.com/aZejCgY.png"}),i=window.labels=j.layers.labels=L.tileLayer(k,{pane:"tilePane"}),a=window.ap=this.makeGeoJSONLayer(window.apData,"ap"),g=window.ep=this.makeGeoJSONLayer(window.epData,"ep"),p=window.usNoData=this.makeGeoJSONLayer(window.usNoDataData,"usNoData"),e=window.canada=this.makeGeoJSONLayer(window.canadaData,"usNoData"),m=window.mexico=this.makeGeoJSONLayer(window.mexicoData,"usNoData"),this.addLayer(b,0),$.cookie("welcomed")&&(this.addLayer(h,2),this.addLayer(a,3),this.addLayer(g,4)),this.addLayer(i,5),this.addLayer(p,6),this.addLayer(e,6),this.addLayer(m,6),l.addControl(L.control.zoom({position:"bottomleft"})),this.setEvents()}}),h=j.QueryView=Backbone.View.extend({template:"#queryTemplate",initialize:function(){return this.model=new c,this.listenTo(this.model,"change",this.render)},serialize:function(){return{query:this.model.attributes}},getQuery:function(a){var b;return b=this,this.model.fetch({data:{lng:a[0],lat:a[1]},type:"POST",success:function(){return setTimeout(function(){return $(".legend-wrapper").hasClass("active")||$("#legend-toggle").trigger("click"),$("#query").hasClass("hidden")?($("#query").removeClass("hidden"),$("#query").addClass("active")):void 0},100)}})}}),f=j.LegendView=Backbone.View.extend({template:"#legendTemplate",events:{"click #legend":function(a){return a.stopPropagation()},"click #legend-toggle":function(){return $(".legend-wrapper").hasClass("active")?($(".legend-wrapper").addClass("invisible"),setTimeout(function(){return $(".legend-wrapper, #legend-toggle").removeClass("active")},1)):($(".legend-wrapper, #legend-toggle").addClass("active"),setTimeout(function(){return $(".legend-wrapper").removeClass("invisible")},150))},"click .switch-container":function(a){var b,c,d,e,f;return a.stopPropagation(),e=j.map,f=$(a.currentTarget).find(".ios-switch").data("layer"),d=j.layers[f],b=j.layers.apLayer,c=j.layers.epLayer,$(a.currentTarget).find(".ios-switch").is(":checked")?d===b?e.hasLayer(c)?(e.removeLayer(b),e.removeLayer(c),e.addLayer(window.ap,2),e.addLayer(window.ep,3)):e.addLayer(window.ap,2):e.addLayer(d===c?window.ep:d):e.hasLayer(d)?e.removeLayer(d):void 0}},views:{"#query":new h},afterRender:function(){var a,b,c,d,e,f,g,h;for(g=this,a=_.range(0,13,1),e=[],h=document.querySelectorAll('input[type="checkbox"].ios-switch'),d=0,f=h.length;f>d;d++)c=h[d],b=document.createElement("div"),b.className="switch",c.parentNode.insertBefore(b,c.nextSibling);return g.$el.find(".apRange").append("<div class='ap-values'></div>"),$(a).each(function(a){var b,c;return b=$('<div><i style="background:'+j.getColor("ap",this)+'"></i></div>'),a%4===0&&(c="<span>+"+this+"%</span>",b.append(c)),g.$el.find(".ap-values").append(b)}),g.$el.find(".apRange").append("<div class='ap-arrow'></div>"),g.$el.find(".apRange").append("<span class='ap-text'>Increasing Average Precipitation</span>"),g.$el.appendTo(l.$el.find("#legend")),$.cookie("welcomed")&&($("#floods-switch").prop("checked",!0),$("#apLayer-switch").prop("checked",!0),$("#epLayer-switch").prop("checked",!0)),$("[data-toggle=tooltip]").tooltip({placement:"left"})}}),d=j.FloatLayout=Backbone.Layout.extend({template:"#floatLayout",initialize:function(){var a;return a=new i,$.cookie("welcomed")?void 0:(this.insertView("#welcome",a),$.cookie("welcomed",!0))},views:{"#header":new e,map:new g,"#legend":new f}}),l=j.layout=new d,l.$el.appendTo("#main"),l.render()})}).call(this),function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{return a=decodeURIComponent(a.replace(g," ")),h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setTime(+k+864e5*j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0===a.cookie(b)?!1:(a.cookie(b,"",a.extend({},c,{expires:-1})),!a.cookie(b))}}),L.LinearFunction=L.Class.extend({initialize:function(a,b,c){this.setOptions(c),this.setRange(a,b)},_calculateParameters:function(a,b){0===this._xRange?(this._slope=0,this._b=a.y):(this._slope=(b.y-a.y)/this._xRange,this._b=a.y-this._slope*a.x)},_arrayToPoint:function(a){return{x:a[0],y:a[1]}},setOptions:function(a){L.Util.setOptions(this,a),this._preProcess=this.options.preProcess,this._postProcess=this.options.postProcess},getBounds:function(){var a=Math.min(this._minPoint.x,this._maxPoint.x),b=Math.max(this._minPoint.x,this._maxPoint.x),c=Math.min(this._minPoint.y,this._maxPoint.y),d=Math.max(this._minPoint.y,this._maxPoint.y);return[new L.Point(a,c),new L.Point(b,d)]},setRange:function(a,b){return a=a instanceof Array?this._arrayToPoint(a):a,b=b instanceof Array?this._arrayToPoint(b):b,this._minPoint=a,this._maxPoint=b,this._xRange=b.x-a.x,this._calculateParameters(a,b),this},setMin:function(a){return this.setRange(a,this._maxPoint),this},setMax:function(a){return this.setRange(this._minPoint,a),this},setPreProcess:function(a){return this._preProcess=a,this},setPostProcess:function(a){return this._postProcess=a,this},evaluate:function(a){var b;return this._preProcess&&(a=this._preProcess(a)),b=Number((this._slope*a).toFixed(6))+Number(this._b.toFixed(6)),this._postProcess&&(b=this._postProcess(b)),b},random:function(){var a=Math.random()*this._xRange+this._minPoint.x;return this.evaluate(a)},sample:function(a){a=Math.max(a,2);for(var b=a-1,c=this._xRange/b,d=this._minPoint.x,e=[];d<=this._maxPoint.x;)e.push(this.evaluate(d)),d+=c;return e},samplePoints:function(a){a=Math.max(a,2);for(var b=a-1,c=this._xRange/b,d=this._minPoint.x,e=[];d<=this._maxPoint.x;)e.push(new L.Point(d,this.evaluate(d))),d+=c;return e},getIntersectionPoint:function(a){var b=null;if(this._slope!==a._slope){var c=(this._b-a._b)/(a._slope-this._slope),d=this.evaluate(c);b=new L.Point(c,d)}return b}}),L.ColorFunction=L.LinearFunction.extend({options:{alpha:1,includeAlpha:!1},initialize:function(a,b,c){L.Util.setOptions(this,c),this._parts=[],this._dynamicPart=null,this._outputPrecision=0,this._prefix=null,this._formatOutput=function(a){return a.toFixed(this._outputPrecision)},this._mapOutput=function(a){for(var b=[],c=0;c<this._parts.length;++c){var d=this._parts[c];b.push(a[d])}return this.options.includeAlpha&&b.push(this.options.alpha),b},this._getColorString=function(a){a=this._formatOutput(a),this.options[this._dynamicPart]=a;var b=this._mapOutput(this.options);return this._writeColor(this._prefix,b)},this._writeColor=function(a,b){return this.options.includeAlpha&&(a+="a"),a+"("+b.join(",")+")"},c=this.options;var d=function(a){c&&c.postProcess&&(a=c.postProcess.call(this,a));var b=this._getColorString(a);return(L.Browser.ie&&b.indexOf("hsl")>-1||c.rgb)&&(b=L.hslColor(b).toRGBString()),b};L.LinearFunction.prototype.initialize.call(this,a,b,{preProcess:this.options.preProcess,postProcess:d})}}),L.HSLColorFunction=L.ColorFunction.extend({initialize:function(a,b,c){L.ColorFunction.prototype.initialize.call(this,a,b,c),this._parts=["outputHue","outputSaturation","outputLuminosity"],this._prefix="hsl",this._outputPrecision=2}}),L.RGBColorFunction=L.ColorFunction.extend({initialize:function(a,b,c){L.ColorFunction.prototype.initialize.call(this,a,b,c),this._parts=["outputRed","outputBlue","outputGreen"],this._prefix="rgb",this._outputPrecision=0}}),L.RGBRedFunction=L.LinearFunction.extend({options:{outputGreen:0,outputBlue:0},initialize:function(a,b,c){L.RGBColorFunction.prototype.initialize.call(this,a,b,c),this._dynamicPart="outputRed"}}),L.RGBBlueFunction=L.LinearFunction.extend({options:{outputRed:0,outputGreen:0},initialize:function(a,b,c){L.RGBColorFunction.prototype.initialize.call(this,a,b,c),this._dynamicPart="outputBlue"}}),L.RGBGreenFunction=L.LinearFunction.extend({options:{outputRed:0,outputBlue:0},initialize:function(a,b,c){L.RGBColorFunction.prototype.initialize.call(this,a,b,c),this._dynamicPart="outputGreen"}}),L.RGBColorBlendFunction=L.LinearFunction.extend({initialize:function(a,b,c,d){c=new L.RGBColor(c),d=new L.RGBColor(d);var e=c.r(),f=d.r(),g=c.g(),h=d.g(),i=c.b(),j=d.b();this._minX=a,this._maxX=b,this._redFunction=new L.LinearFunction(new L.Point(a,e),new L.Point(b,f)),this._greenFunction=new L.LinearFunction(new L.Point(a,g),new L.Point(b,h)),this._blueFunction=new L.LinearFunction(new L.Point(a,i),new L.Point(b,j))},getBounds:function(){var a=this._redFunction.getBounds(),b=this._greenFunction.getBounds(),c=this._blueFunction.getBounds(),d=Math.min(a[0].y,b[0].y,c[0].y),e=Math.max(a[0].y,b[0].y,c[0].y);return[new L.Point(a[0].x,d),new L.Point(a[1].x,e)]},evaluate:function(a){return new L.RGBColor([this._redFunction.evaluate(a),this._greenFunction.evaluate(a),this._blueFunction.evaluate(a)]).toRGBString()}}),L.HSLHueFunction=L.HSLColorFunction.extend({options:{outputSaturation:"100%",outputLuminosity:"50%"},initialize:function(a,b,c){L.HSLColorFunction.prototype.initialize.call(this,a,b,c),this._dynamicPart="outputHue"}}),L.HSLSaturationFunction=L.LinearFunction.extend({options:{outputHue:0,outputLuminosity:"50%"},initialize:function(a,b,c){L.HSLColorFunction.prototype.initialize.call(this,a,b,c),this._formatOutput=function(a){return(100*a).toFixed(this._outputPrecision)+"%"},this._dynamicPart="outputSaturation"}}),L.HSLLuminosityFunction=L.LinearFunction.extend({options:{outputHue:0,outputSaturation:"100%"},initialize:function(a,b,c){L.HSLColorFunction.prototype.initialize.call(this,a,b,c),this._formatOutput=function(a){return(100*a).toFixed(this._outputPrecision)+"%"},this._dynamicPart="outputLuminosity"}}),L.HSLColorBlendFunction=L.LinearFunction.extend({initialize:function(a,b,c,d){c=new L.HSLColor(c),d=new L.HSLColor(d);var e=c.h(),f=d.h(),g=c.s(),h=d.s(),i=c.l(),j=d.l();this._minX=a,this._maxX=b,this._hueFunction=new L.LinearFunction(new L.Point(a,e),new L.Point(b,f)),this._saturationFunction=new L.LinearFunction(new L.Point(a,g),new L.Point(b,h)),this._luminosityFunction=new L.LinearFunction(new L.Point(a,i),new L.Point(b,j))},getBounds:function(){var a=this._hueFunction.getBounds(),b=this._saturationFunction.getBounds(),c=this._luminosityFunction.getBounds(),d=Math.min(a[0].y,b[0].y,c[0].y),e=Math.max(a[0].y,b[0].y,c[0].y);return[new L.Point(a[0].x,d),new L.Point(a[1].x,e)]},evaluate:function(a){return new L.HSLColor([this._hueFunction.evaluate(a),this._saturationFunction.evaluate(a),this._luminosityFunction.evaluate(a)]).toHSLString()}}),L.PiecewiseFunction=L.LinearFunction.extend({initialize:function(a,b){L.Util.setOptions(this,b),this._functions=a;var c,d;c=a[0].getBounds()[0],d=a[a.length-1].getBounds()[1],L.LinearFunction.prototype.initialize.call(this,c,d,{preProcess:this.options.preProcess,postProcess:this.options.postProcess})},_getFunction:function(a){for(var b,c,d,e,f=!1,g=0;g<this._functions.length;++g)if(e=this._functions[g],b=e.getBounds(),c=b[0],d=b[1],a>=c.x&&a<d.x){f=!0;break}return f?e:this._functions[this._functions.length-1]},evaluate:function(a){var b,c=null;return this._preProcess&&(a=this._preProcess(a)),b=this._getFunction(a),b&&(c=b.evaluate(a),this._postProcess&&(c=this._postProcess(c))),c}}),L.CustomColorFunction=L.PiecewiseFunction.extend({options:{interpolate:!0},initialize:function(a,b,c,d){var e,f=b-a,g=f/(c.length-1),h=[];L.Util.setOptions(this,d);for(var i=0;i<c.length;++i){var j=Math.min(i+1,c.length-1);e=this.options.interpolate?new L.RGBColorBlendFunction(a+g*i,a+g*j,c[i],c[j]):new L.RGBColorBlendFunction(a+g*i,a+g*j,c[i],c[i]),h.push(e)}L.PiecewiseFunction.prototype.initialize.call(this,h)}}),L.CategoryFunction=L.Class.extend({initialize:function(a,b){L.Util.setOptions(this,b),this._categoryKeys=Object.keys(a),this._categoryMap=a,this._preProcess=this.options.preProcess,this._postProcess=this.options.postProcess},evaluate:function(a){var b;return this._preProcess&&(a=this._preProcess(a)),b=this._categoryMap[a],this._postProcess&&(b=this._postProcess(b)),b},getCategories:function(){return this._categoryKeys}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;d>c;c++)if(this[c]===a)return c;return-1}),Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){var f,g,h;if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");f=[];for(g in e)a.call(e,g)&&f.push(g);if(b)for(h=0;d>h;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),L.Util.guid=function(){var a=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},L.Util.getProperty=function(a,b,c){return b in a?a[b]:c},L.Util.setFieldValue=function(a,b,c){for(var d,e=b.split("."),f=a,g=0;g<e.length-1;++g)d=e[g],f[d]=f[d]||{},f=f[d];f[e[e.length-1]]=c},L.Util.getFieldValue=function(a,b){var c=null;if(b){for(var d,e,f,g,h,i,j,k=b.split("."),l=a,m=-1,n=0;n<k.length;++n)if(d=k[n],m=d.indexOf("["),m>-1){i=d.substring(m),d=d.substring(0,m),i=i.replace("[","").replace("]",""),e=i.split("="),f=e[0],g=e[1],l=l[d];for(var o=0;o<l.length;++o)h=l[o],j=h[f],j&&j===g&&(l=h)}else{if(!l||!l.hasOwnProperty(d)){l=null;break}l=l[d]}c=l}else c=a;return c},L.Util.getNumericRange=function(a,b){var c=Number.MAX_VALUE,d=Number.MIN_VALUE;for(var e in a)if(a.hasOwnProperty(e)){var f=a[e],g=L.Util.getFieldValue(f,b);c=Math.min(c,g),d=Math.max(d,g)}return[c,d]},L.Util.pointToGeoJSON=function(){var a={type:"Feature",geometry:{type:"Point",coordinates:[this._latlng[1],this._latlng[0]]},properties:{}};for(var b in this.options)if(this.options.hasOwnProperty(b)){var c=this.options[b];"function"!=typeof c&&(a.properties[b]=c)}return a},L.Util.updateLayer=function(a,b){a.eachLayer&&!a instanceof L.FeatureGroup?a.eachLayer(function(a){L.Util.updateLayer(a,b)}):b.call(this,a)},L.CategoryLegend=L.Class.extend({initialize:function(a){L.Util.setOptions(this,a)},generate:function(a){a=a||{};var b=document.createElement("div"),c=L.DomUtil.create("div","legend",b),d=a.className,e=this.options;d&&L.DomUtil.addClass(c,d),a.title&&(L.DomUtil.create("div","legend-title",c).innerHTML=a.title);for(var f in e){categoryOptions=e[f];var g=categoryOptions.displayName||f,h=L.DomUtil.create("div","data-layer-legend",c),i=L.DomUtil.create("div","legend-box",h);L.DomUtil.create("div","key",h).innerHTML=g,L.StyleConverter.applySVGStyle(i,categoryOptions)}return b.innerHTML}}),L.LegendIcon=L.DivIcon.extend({initialize:function(a,b,c){var d,e=document.createElement("div"),f=L.DomUtil.create("div","legend",e),g=L.DomUtil.create("div","title",f),h=L.DomUtil.create("div","legend-box",f),i=L.DomUtil.create("div","legend-values",f),j=b.title||b.name;j&&(g.innerHTML=j);for(var k in a)d=a[k],L.DomUtil.create("div","key",i).innerHTML=d.name||k,L.DomUtil.create("div","value",i).innerHTML=d.value;L.StyleConverter.applySVGStyle(h,b),h.style.height="5px",c.html=e.innerHTML,c.className=c.className||"legend-icon",L.DivIcon.prototype.initialize.call(this,c)}}),L.legendIcon=function(a,b,c){return new L.LegendIcon(a,b,c)},L.GeometryUtils={getName:function(a){var b=null;if(a&&a.features)for(var c=0;c<a.features.length;++c){var d=a.features[c];if(d.properties&&d.properties.name){b=d.properties.name;break}}return b},getGeoJSONLocation:function(a,b,c,d){var e=new L.GeoJSON(a,{pointToLayer:function(a,e){var f={location:e,text:c?L.Util.getFieldValue(b,c):[e.lat.toFixed(3),e.lng.toFixed(3)].join(", "),center:e};return d(f,b)}}),f=null;try{f=L.GeometryUtils.loadCentroid(a)}catch(g){console.log("Error loading centroid for "+JSON.stringify(a))}return{location:e,text:c?L.Util.getFieldValue(b,c):null,center:f}},mergeProperties:function(a,b,c){var d,e,f=b.features,g=L.GeometryUtils.indexFeatureCollection(f,c),h={type:"FeatureCollection",features:[]};
for(var i in a)if(a.hasOwnProperty(i)&&(d=a[i],e=d[c])){var j=g[e];for(var k in d)j.properties[k]=d[k];h.features.push(j)}return h},indexFeatureCollection:function(a,b){for(var c,d,e,f=a.features,g={},h=0;h<f.length;++h)if(c=f[h],d=c.properties,e=d[b],e in g){var i=g[e];"GeometryCollection"!==i.geometry.type?g[e]={type:"Feature",geometry:{type:"GeometryCollection",geometries:[c.geometry,i.geometry]}}:i.geometry.geometries.push(c.geometry)}else g[e]=c;return g},arrayToMap:function(a,b,c){for(var d,e,f,g={},h=0;h<a.length;++h)d=a[h],e=d[b],f=c?d[c]:d,g[e]=f;return g},arrayToMaps:function(a,b){for(var c,d,e,f,g,h,i,j=[],k=0;k<b.length;++k)j.push({});for(var l=0;l<a.length;++l){d=a[l];for(var m=0;m<b.length;++m)c=j[m],g=b[m],h=g.from,i=g.to,e=d[h],f=i?d[i]:d,c[e]=f}return j},loadCentroid:function(a){var b,c,d,e=null;if(a.geometry&&"Point"===a.geometry.type)e=new L.LatLng(a.geometry.coordinates[1],a.geometry.coordinates[0]);else if("undefined"!=typeof jsts){var f=new jsts.io.GeoJSONParser,g=f.read(a);if(g.getCentroid)b=g.getCentroid(),c=b.coordinate.x,d=b.coordinate.y;else if(g.features){for(var h=0,i=0,j=0;j<g.features.length;++j)b=g.features[j].geometry.getCentroid(),h+=b.coordinate.x,i+=b.coordinate.y;c=h/g.features.length,d=i/g.features.length}else b=g.geometry.getCentroid(),c=b.coordinate.x,d=b.coordinate.y;e=new L.LatLng(d,c)}return e},loadCentroids:function(a){var b,c={};for(var d in a)b=a[d],c[d]=L.GeometryUtils.loadCentroid(b);return c}},L.SVGPathBuilder=L.Class.extend({initialize:function(a,b,c){this._points=a||[],this._innerPoints=b||[],L.Util.setOptions(this,c)},options:{closePath:!0},_getPathString:function(a,b){var c="";if(a.length>0){var d=a[0],b=null!==b?b:2,e="M",f="L",g="Z";L.Browser.vml&&(b=0,e="m",f="l",g="xe"),c=e+d.x.toFixed(b)+","+d.y.toFixed(b);for(var h=1;h<a.length;h++)d=a[h],c+=f+d.x.toFixed(b)+","+d.y.toFixed(b);this.options.closePath&&(c+=g)}return c},addPoint:function(a,b){b?this._innerPoints.push(a):this._points.push(a)},build:function(a){a=a||this.options.digits;var b=this._getPathString(this._points,a);return this._innerPoints&&(b+=this._getPathString(this._innerPoints,a)),b}}),L.StyleConverter={keyMap:{fillColor:{property:["background-color"],valueFunction:function(a){return a}},color:{property:["color","border-top-color","border-right-color","border-bottom-color","border-left-color"],valueFunction:function(a){return a}},weight:{property:["border-width"],valueFunction:function(a){return Math.ceil(a)+"px"}},stroke:{property:["border-style"],valueFunction:function(a){return a===!0?"solid":"none"}},dashArray:{property:["border-style"],valueFunction:function(a){var b="solid";return a&&(b="dashed"),b}},barThickness:{property:["height"],valueFunction:function(a){return a+"px"}},radius:{property:["height"],valueFunction:function(a){return 2*a+"px"}},fillOpacity:{property:["opacity"],valueFunction:function(a){return a}}},applySVGStyle:function(a,b,c){var d=L.StyleConverter.keyMap;c&&(d=L.Util.extend(d,c)),a.style.borderStyle="solid";for(var e in b)L.StyleConverter.setCSSProperty(a,e,b[e],d);return a},setCSSProperty:function(a,b,c,d){var d=d||L.StyleConverter.keyMap,e=d[b],f="";if(e)for(var g=e.property,h=0,i=g.length;i>h;++h)f+=g[h]+":"+e.valueFunction(c)+";";return a.style.cssText+=f,a}},L.StylesBuilder=L.Class.extend({initialize:function(a,b){this._categories=a,this._styleFunctionMap=b,this._buildStyles()},_buildStyles:function(){for(var a,b,c,d={},e=0;e<this._categories.length;++e){a=this._categories[e],d[a]={};for(var f in this._styleFunctionMap)b=this._styleFunctionMap[f],c=b.evaluate?b.evaluate(e):"function"==typeof b?b(e):b,d[a][f]=c}this._styleMap=d},getStyles:function(){return this._styleMap}}),L.PaletteBuilder=L.Class.extend({initialize:function(a){this._styleFunctionMap=a},generate:function(a){a=a||{};var b=document.createElement("div"),c=L.DomUtil.create("div","palette",b),d=a.count||10,e=function(a){for(var b=[],c=0;a>c;++c)b.push(c);return b}(d),f=new L.StylesBuilder(e,this._styleFunctionMap),g=f.getStyles();a.className&&L.DomUtil.addClass(c,a.className);for(var h in g){var i=L.DomUtil.create("i","palette-element",c),j=g[h];L.StyleConverter.applySVGStyle(i,j)}return b.innerHTML}}),L.HTMLUtils={buildTable:function(a,b,c){function d(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1}b=b||"table table-condensed table-striped table-bordered";var e=L.DomUtil.create("table",b),f=L.DomUtil.create("thead","",e),g=L.DomUtil.create("tbody","",e);f.innerHTML="<tr><th>Name</th><th>Value</th></tr>",c=c||[];for(var h in a)if(a.hasOwnProperty(h)&&!d(c,h)){var i=a[h];if("object"==typeof i){var j=document.createElement("div");j.appendChild(L.HTMLUtils.buildTable(i,c)),i=j.innerHTML}g.innerHTML+="<tr><td>"+h+"</td><td>"+i+"</td></tr>"}return e}},L.AnimationUtils={animate:function(a,b,c,d){var e=d.delay||0,f=d.frames||30,g=d.duration||500,h={},i=d.easeFunction||function(a){return a},j=d.complete,k=g/f;for(var l in b)"color"!=l&&"fillColor"!=l&&c[l]?h[l]=new L.LinearFunction([0,b[l]],[f-1,c[l]]):("color"==l||"fillColor"==l)&&(h[l]=new L.RGBColorBlendFunction(0,f-1,b[l],c[l]));var m={},n=0,o=function(){for(var b in h)m[b]=h[b].evaluate(n);a.options=L.extend({},a.options,m),a.setStyle(a.options).redraw(),n++,k=i(k),f>n?setTimeout(o,k):j()};setTimeout(o,e)}},L.Color=L.Class.extend({initialize:function(a){this._rgb=[0,0,0],this._hsl=[0,1,.5],this._a=1,a&&this.parseColorDef(a)},parseColorDef:function(){},rgbToHSL:function(a,b,c){a/=255,b/=255,c/=255;var d,e,f=Math.max(a,b,c),g=Math.min(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return[d,e,h]},hslToRGB:function(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(0==b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return[Math.floor(255*e),Math.floor(255*f),Math.floor(255*g)]},setRGB:function(a,b,c){return this._rgb=[a,b,c],this._hsl=this.rgbToHSL(a,b,c),this},setHSL:function(a,b,c){return this._hsl=[a,b,c],this._rgb=this.hslToRGB(a,b,c),this},toHSL:function(){return this._hsl},toHSLString:function(){var a="hsl";return this._a<1&&(a+="a"),a+"("+(360*this._hsl[0]).toFixed(1)+","+(100*this._hsl[1]).toFixed(0)+"%,"+(100*this._hsl[2]).toFixed(0)+"%)"},toRGB:function(){return this._rgb},toRGBString:function(){var a;if(this._a<1)a="rgba("+this._rgb[0].toFixed(0)+","+this._rgb[1].toFixed(0)+","+this._rgb[2].toFixed(0)+","+this._a.toFixed(1)+")";else{for(var b=[this._rgb[0].toString(16),this._rgb[1].toString(16),this._rgb[2].toString(16)],c=0;c<b.length;++c)1===b[c].length&&(b[c]="0"+b[c]);a="#"+b.join("")}return a},r:function(a){return arguments.length?this.setRGB(a,this._rgb[1],this._rgb[2]):this._rgb[0]},g:function(a){return arguments.length?this.setRGB(this._rgb[0],a,this._rgb[2]):this._rgb[1]},b:function(a){return arguments.length?this.setRGB(this._rgb[0],this._rgb[1],a):this._rgb[2]},h:function(a){return arguments.length?this.setHSL(a,this._hsl[1],this._hsl[2]):this._hsl[0]},s:function(a){return arguments.length?this.setHSL(this._hsl[0],a,this._hsl[2]):this._hsl[1]},l:function(a){return arguments.length?this.setHSL(this._hsl[0],this._hsl[1],a):this._hsl[2]},a:function(a){return arguments.length?(this._a=a,this):this._a}}),L.RGBColor=L.Color.extend({initialize:function(a){L.Color.prototype.initialize.call(this,a)},parseColorDef:function(a){var b,c,d,e,f=a instanceof Array,g=0===a.indexOf("#"),h=[];f?(b=Math.floor(a[0]),c=Math.floor(a[1]),d=Math.floor(a[2]),e=4===a.length?a[3]:1):g?(a=a.replace("#",""),b=parseInt(a.substring(0,2),16),c=parseInt(a.substring(2,4),16),d=parseInt(a.substring(4,6),16),e=8===a.length?parseInt(a.substring(6,8),16):1):(h=a.replace("rgb","").replace("a","").replace(/\s+/g,"").replace("(","").replace(")","").split(","),b=parseInt(h[0]),c=parseInt(h[1]),d=parseInt(h[2]),e=4===h.length?parseInt(h[3]):1),this.setRGB(b,c,d),this._a=e}}),L.rgbColor=function(a){return new L.RGBColor(a)},L.HSLColor=L.Color.extend({initialize:function(a){L.Color.prototype.initialize.call(this,a)},parseColorDef:function(a){var b,c,d,e,f=a instanceof Array;if(f)b=a[0],c=a[1],d=a[2],e=4===a.length?a[3]:1;else{var g=a.replace("hsl","").replace("a","").replace("(","").replace(/\s+/g,"").replace(/%/g,"").replace(")","").split(",");b=Number(g[0])/360,c=Number(g[1])/100,d=Number(g[2])/100,e=4===g.length?parseInt(g[3]):1}this.setHSL(b,c,d),this._a=e}}),L.hslColor=function(a){return new L.HSLColor(a)},L.Animation=L.Class.extend({initialize:function(a,b){this._easeFunction=a,this._animateFrame=b},run:function(a,b){this.stop(),this._el=a,this._inProgress=!0,this._duration=b.duration||.25,this._animationOptions=b,this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=L.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var a=+new Date-this._startTime,b=1e3*this._duration;b>a?this._runFrame(this._easeFunction(a/b)):(this._runFrame(1),this._complete())},_runFrame:function(a){this._animateFrame(a),this.fire("step")},_complete:function(){L.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")}}),L.ColorBrewer={Sequential:{YlGn:{3:["#f7fcb9","#addd8e","#31a354"],4:["#ffffcc","#c2e699","#78c679","#238443"],5:["#ffffcc","#c2e699","#78c679","#31a354","#006837"],6:["#ffffcc","#d9f0a3","#addd8e","#78c679","#31a354","#006837"],7:["#ffffcc","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],8:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#005a32"],9:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"]},YlGnBu:{3:["#edf8b1","#7fcdbb","#2c7fb8"],4:["#ffffcc","#a1dab4","#41b6c4","#225ea8"],5:["#ffffcc","#a1dab4","#41b6c4","#2c7fb8","#253494"],6:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#2c7fb8","#253494"],7:["#ffffcc","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],8:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"],9:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"]},GnBu:{3:["#e0f3db","#a8ddb5","#43a2ca"],4:["#f0f9e8","#bae4bc","#7bccc4","#2b8cbe"],5:["#f0f9e8","#bae4bc","#7bccc4","#43a2ca","#0868ac"],6:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#43a2ca","#0868ac"],7:["#f0f9e8","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],8:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#08589e"],9:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"]},BuGn:{3:["#e5f5f9","#99d8c9","#2ca25f"],4:["#edf8fb","#b2e2e2","#66c2a4","#238b45"],5:["#edf8fb","#b2e2e2","#66c2a4","#2ca25f","#006d2c"],6:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#2ca25f","#006d2c"],7:["#edf8fb","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],8:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#005824"],9:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"]},PuBuGn:{3:["#ece2f0","#a6bddb","#1c9099"],4:["#f6eff7","#bdc9e1","#67a9cf","#02818a"],5:["#f6eff7","#bdc9e1","#67a9cf","#1c9099","#016c59"],6:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#1c9099","#016c59"],7:["#f6eff7","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],8:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016450"],9:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"]},PuBu:{3:["#ece7f2","#a6bddb","#2b8cbe"],4:["#f1eef6","#bdc9e1","#74a9cf","#0570b0"],5:["#f1eef6","#bdc9e1","#74a9cf","#2b8cbe","#045a8d"],6:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#2b8cbe","#045a8d"],7:["#f1eef6","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],8:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#034e7b"],9:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"]},BuPu:{3:["#e0ecf4","#9ebcda","#8856a7"],4:["#edf8fb","#b3cde3","#8c96c6","#88419d"],5:["#edf8fb","#b3cde3","#8c96c6","#8856a7","#810f7c"],6:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8856a7","#810f7c"],7:["#edf8fb","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],8:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#6e016b"],9:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"]},RdPu:{3:["#fde0dd","#fa9fb5","#c51b8a"],4:["#feebe2","#fbb4b9","#f768a1","#ae017e"],5:["#feebe2","#fbb4b9","#f768a1","#c51b8a","#7a0177"],6:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#c51b8a","#7a0177"],7:["#feebe2","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],8:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177"],9:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"]},PuRd:{3:["#e7e1ef","#c994c7","#dd1c77"],4:["#f1eef6","#d7b5d8","#df65b0","#ce1256"],5:["#f1eef6","#d7b5d8","#df65b0","#dd1c77","#980043"],6:["#f1eef6","#d4b9da","#c994c7","#df65b0","#dd1c77","#980043"],7:["#f1eef6","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],8:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#91003f"],9:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"]},OrRd:{3:["#fee8c8","#fdbb84","#e34a33"],4:["#fef0d9","#fdcc8a","#fc8d59","#d7301f"],5:["#fef0d9","#fdcc8a","#fc8d59","#e34a33","#b30000"],6:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#e34a33","#b30000"],7:["#fef0d9","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],8:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#990000"],9:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"]},YlOrRd:{3:["#ffeda0","#feb24c","#f03b20"],4:["#ffffb2","#fecc5c","#fd8d3c","#e31a1c"],5:["#ffffb2","#fecc5c","#fd8d3c","#f03b20","#bd0026"],6:["#ffffb2","#fed976","#feb24c","#fd8d3c","#f03b20","#bd0026"],7:["#ffffb2","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],8:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#b10026"],9:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"]},YlOrBr:{3:["#fff7bc","#fec44f","#d95f0e"],4:["#ffffd4","#fed98e","#fe9929","#cc4c02"],5:["#ffffd4","#fed98e","#fe9929","#d95f0e","#993404"],6:["#ffffd4","#fee391","#fec44f","#fe9929","#d95f0e","#993404"],7:["#ffffd4","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],8:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#8c2d04"],9:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"]},Purples:{3:["#efedf5","#bcbddc","#756bb1"],4:["#f2f0f7","#cbc9e2","#9e9ac8","#6a51a3"],5:["#f2f0f7","#cbc9e2","#9e9ac8","#756bb1","#54278f"],6:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#756bb1","#54278f"],7:["#f2f0f7","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],8:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#4a1486"],9:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"]},Blues:{3:["#deebf7","#9ecae1","#3182bd"],4:["#eff3ff","#bdd7e7","#6baed6","#2171b5"],5:["#eff3ff","#bdd7e7","#6baed6","#3182bd","#08519c"],6:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#3182bd","#08519c"],7:["#eff3ff","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],8:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#084594"],9:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"]},Greens:{3:["#e5f5e0","#a1d99b","#31a354"],4:["#edf8e9","#bae4b3","#74c476","#238b45"],5:["#edf8e9","#bae4b3","#74c476","#31a354","#006d2c"],6:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#31a354","#006d2c"],7:["#edf8e9","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],8:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#005a32"],9:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"]},Oranges:{3:["#fee6ce","#fdae6b","#e6550d"],4:["#feedde","#fdbe85","#fd8d3c","#d94701"],5:["#feedde","#fdbe85","#fd8d3c","#e6550d","#a63603"],6:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#e6550d","#a63603"],7:["#feedde","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],8:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#8c2d04"],9:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"]},Reds:{3:["#fee0d2","#fc9272","#de2d26"],4:["#fee5d9","#fcae91","#fb6a4a","#cb181d"],5:["#fee5d9","#fcae91","#fb6a4a","#de2d26","#a50f15"],6:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#de2d26","#a50f15"],7:["#fee5d9","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],8:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#99000d"],9:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"]},Greys:{3:["#f0f0f0","#bdbdbd","#636363"],4:["#f7f7f7","#cccccc","#969696","#525252"],5:["#f7f7f7","#cccccc","#969696","#636363","#252525"],6:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#636363","#252525"],7:["#f7f7f7","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],8:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525"],9:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"]}},Diverging:{PuOr:{3:["#f1a340","#f7f7f7","#998ec3"],4:["#e66101","#fdb863","#b2abd2","#5e3c99"],5:["#e66101","#fdb863","#f7f7f7","#b2abd2","#5e3c99"],6:["#b35806","#f1a340","#fee0b6","#d8daeb","#998ec3","#542788"],7:["#b35806","#f1a340","#fee0b6","#f7f7f7","#d8daeb","#998ec3","#542788"],8:["#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788"],9:["#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788"],10:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],11:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"]},BrBG:{3:["#d8b365","#f5f5f5","#5ab4ac"],4:["#a6611a","#dfc27d","#80cdc1","#018571"],5:["#a6611a","#dfc27d","#f5f5f5","#80cdc1","#018571"],6:["#8c510a","#d8b365","#f6e8c3","#c7eae5","#5ab4ac","#01665e"],7:["#8c510a","#d8b365","#f6e8c3","#f5f5f5","#c7eae5","#5ab4ac","#01665e"],8:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e"],9:["#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e"],10:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],11:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"]},PRGn:{3:["#af8dc3","#f7f7f7","#7fbf7b"],4:["#7b3294","#c2a5cf","#a6dba0","#008837"],5:["#7b3294","#c2a5cf","#f7f7f7","#a6dba0","#008837"],6:["#762a83","#af8dc3","#e7d4e8","#d9f0d3","#7fbf7b","#1b7837"],7:["#762a83","#af8dc3","#e7d4e8","#f7f7f7","#d9f0d3","#7fbf7b","#1b7837"],8:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837"],9:["#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837"],10:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],11:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"]},PiYG:{3:["#e9a3c9","#f7f7f7","#a1d76a"],4:["#d01c8b","#f1b6da","#b8e186","#4dac26"],5:["#d01c8b","#f1b6da","#f7f7f7","#b8e186","#4dac26"],6:["#c51b7d","#e9a3c9","#fde0ef","#e6f5d0","#a1d76a","#4d9221"],7:["#c51b7d","#e9a3c9","#fde0ef","#f7f7f7","#e6f5d0","#a1d76a","#4d9221"],8:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221"],9:["#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221"],10:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],11:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"]},RdBu:{3:["#ef8a62","#f7f7f7","#67a9cf"],4:["#ca0020","#f4a582","#92c5de","#0571b0"],5:["#ca0020","#f4a582","#f7f7f7","#92c5de","#0571b0"],6:["#b2182b","#ef8a62","#fddbc7","#d1e5f0","#67a9cf","#2166ac"],7:["#b2182b","#ef8a62","#fddbc7","#f7f7f7","#d1e5f0","#67a9cf","#2166ac"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"]},RdGy:{3:["#ef8a62","#ffffff","#999999"],4:["#ca0020","#f4a582","#bababa","#404040"],5:["#ca0020","#f4a582","#ffffff","#bababa","#404040"],6:["#b2182b","#ef8a62","#fddbc7","#e0e0e0","#999999","#4d4d4d"],7:["#b2182b","#ef8a62","#fddbc7","#ffffff","#e0e0e0","#999999","#4d4d4d"],8:["#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d"],9:["#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d"],10:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],11:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"]},RdYlBu:{3:["#fc8d59","#ffffbf","#91bfdb"],4:["#d7191c","#fdae61","#abd9e9","#2c7bb6"],5:["#d7191c","#fdae61","#ffffbf","#abd9e9","#2c7bb6"],6:["#d73027","#fc8d59","#fee090","#e0f3f8","#91bfdb","#4575b4"],7:["#d73027","#fc8d59","#fee090","#ffffbf","#e0f3f8","#91bfdb","#4575b4"],8:["#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4"],9:["#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"]},Spectral:{3:["#fc8d59","#ffffbf","#99d594"],4:["#d7191c","#fdae61","#abdda4","#2b83ba"],5:["#d7191c","#fdae61","#ffffbf","#abdda4","#2b83ba"],6:["#d53e4f","#fc8d59","#fee08b","#e6f598","#99d594","#3288bd"],7:["#d53e4f","#fc8d59","#fee08b","#ffffbf","#e6f598","#99d594","#3288bd"],8:["#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd"],9:["#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd"],10:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],11:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"]},RdYlGn:{3:["#fc8d59","#ffffbf","#91cf60"],4:["#d7191c","#fdae61","#a6d96a","#1a9641"],5:["#d7191c","#fdae61","#ffffbf","#a6d96a","#1a9641"],6:["#d73027","#fc8d59","#fee08b","#d9ef8b","#91cf60","#1a9850"],7:["#d73027","#fc8d59","#fee08b","#ffffbf","#d9ef8b","#91cf60","#1a9850"],8:["#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850"],9:["#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850"],10:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],11:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"]}},Qualitative:{Accent:{3:["#7fc97f","#beaed4","#fdc086"],4:["#7fc97f","#beaed4","#fdc086","#ffff99"],5:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0"],6:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f"],7:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17"],8:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"]},Dark2:{3:["#1b9e77","#d95f02","#7570b3"],4:["#1b9e77","#d95f02","#7570b3","#e7298a"],5:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e"],6:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02"],7:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d"],8:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]},Paired:{3:["#a6cee3","#1f78b4","#b2df8a"],4:["#a6cee3","#1f78b4","#b2df8a","#33a02c"],5:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],6:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c"],7:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f"],8:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00"],9:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6"],10:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a"],11:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99"],12:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"]},Pastel1:{3:["#fbb4ae","#b3cde3","#ccebc5"],4:["#fbb4ae","#b3cde3","#ccebc5","#decbe4"],5:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6"],6:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc"],7:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd"],8:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec"],9:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},Pastel2:{3:["#b3e2cd","#fdcdac","#cbd5e8"],4:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4"],5:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9"],6:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae"],7:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc"],8:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"]},Set1:{3:["#e41a1c","#377eb8","#4daf4a"],4:["#e41a1c","#377eb8","#4daf4a","#984ea3"],5:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],6:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33"],7:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628"],8:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf"],9:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"]},Set2:{3:["#66c2a5","#fc8d62","#8da0cb"],4:["#66c2a5","#fc8d62","#8da0cb","#e78ac3"],5:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854"],6:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f"],7:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494"],8:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"]},Set3:{3:["#8dd3c7","#ffffb3","#bebada"],4:["#8dd3c7","#ffffb3","#bebada","#fb8072"],5:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3"],6:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462"],7:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69"],8:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5"],9:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9"],10:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd"],11:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5"],12:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"]}}},L.Palettes={huePalette:function(a,b,c,d,e){return new L.HSLHueFunction(new L.Point(a,c),new L.Point(b,d),e)},luminosityPalette:function(a,b,c,d,e){return new L.HSLLuminosityFunction(new L.Point(a,c),new L.Point(b,d),e)},saturationPalette:function(a,b,c,d,e){return new L.HSLSaturationFunction(new L.Point(a,c),new L.Point(b,d),e)},rgbBlendPalette:function(a,b,c,d,e){return new L.RGBColorBlendFunction(a,b,c,d,e)},hslBlendPalette:function(a,b,c,d,e){return new L.HSLColorBlendFunction(a,b,c,d,e)},customColorPalette:function(a,b,c,d){return new L.CustomColorFunction(a,b,c,d)}},L.DynamicColorPalettes={rainbow:{text:"Rainbow",getPalette:function(a,b,c){return L.Palettes.huePalette(a,b,0,300,c)}},greentored:{text:"Green - Red",getPalette:function(a,b,c){return L.Palettes.huePalette(a,b,120,0,c)}},yellowtored:{text:"Yellow - Red",getPalette:function(a,b,c){return L.Palettes.huePalette(a,b,60,0,c)}},orangetored:{text:"Orange - Red",getPalette:function(a,b,c){return L.Palettes.huePalette(a,b,30,0,c)}},redtopurple:{text:"Red - Purple",getPalette:function(a,b,c){return L.Palettes.huePalette(a,b,360,270,c)}},bluetored:{text:"Blue - Red",getPalette:function(a,b,c){return L.Palettes.huePalette(a,b,210,360,c)}},bluetored2:{text:"Blue - Red 2",getPalette:function(a,b,c){return L.Palettes.huePalette(a,b,180,0,c)}},whitetored:{text:"White - Red",getPalette:function(a,b){return L.Palettes.luminosityPalette(a,b,1,.5,L.Util.extend(option,{outputHue:0}))}},whitetoorange:{text:"White - Orange",getPalette:function(a,b){return L.Palettes.luminosityPalette(a,b,1,.5,L.Util.extend(option,{outputHue:30}))}},whitetoyellow:{text:"White - Yellow",getPalette:function(a,b){return L.Palettes.luminosityPalette(a,b,1,.5,L.Util.extend(option,{outputHue:60}))}},whitetogreen:{text:"White - Green",getPalette:function(a,b){return L.Palettes.luminosityPalette(a,b,1,.5,L.Util.extend(option,{outputHue:120}))}},whitetoltblue:{text:"White - Lt. Blue",getPalette:function(a,b){return L.Palettes.luminosityPalette(a,b,1,.5,L.Util.extend(option,{outputHue:180}))}},whitetoblue:{text:"White - Blue",getPalette:function(a,b){return L.Palettes.luminosityPalette(a,b,1,.5,L.Util.extend(option,{outputHue:240}))}},whitetopurple:{text:"White - Purple",getPalette:function(a,b){return L.Palettes.luminosityPalette(a,b,1,.5,L.Util.extend(option,{outputHue:270}))}},graytored:{text:"Gray - Red",getPalette:function(a,b){return L.Palettes.saturationPalette(a,b,0,1,L.Util.extend(option,{outputHue:0}))}},graytoorange:{text:"Gray - Orange",getPalette:function(a,b){return L.Palettes.saturationPalette(a,b,0,1,L.Util.extend(option,{outputHue:30}))}},graytoyellow:{text:"Gray - Yellow",getPalette:function(a,b){return L.Palettes.saturationPalette(a,b,0,1,L.Util.extend(option,{outputHue:60}))}},graytogreen:{text:"Gray - Green",getPalette:function(a,b){return L.Palettes.saturationPalette(a,b,0,1,L.Util.extend(option,{outputHue:120}))}},graytoltblue:{text:"Gray - Lt. Blue",getPalette:function(a,b){return L.Palettes.saturationPalette(a,b,0,1,L.Util.extend(option,{outputHue:180}))}},graytoblue:{text:"Gray - Blue",getPalette:function(a,b){return L.Palettes.saturationPalette(a,b,0,1,L.Util.extend(option,{outputHue:240}))}},graytopurple:{text:"Gray - Purple",getPalette:function(a,b){return L.Palettes.saturationPalette(a,b,0,1,L.Util.extend(option,{outputHue:270}))}}},L.DynamicPaletteElement=L.Class.extend({initialize:function(a,b){this._key=a,this._dynamicPalette=b},generate:function(a){var b=L.DomUtil.create("div","palette"),c=a.count,d=this._dynamicPalette.getPalette(0,c-1),e=a.width,f=!0;void 0!=a.showText&&(f=a.showText),b.setAttribute("data-palette-key",this._key),this._dynamicPalette.text&&f&&(L.DomUtil.create("div","palette-text",b).innerHTML='<i class="icon-ok hidden"></i>'+this._dynamicPalette.text);var g=e/c;a.className&&L.DomUtil.addClass(b,a.className);for(var h=0;c>h;++h){var h=L.DomUtil.create("i","palette-element");for(var i in d){var j=d[i],k=j.evaluate?j.evaluate(h):j;L.StyleConverter.setCSSProperty(h,i,k)}h.style.width=g+"px",b.appendChild(h)}return b}}),L.RegularPolygon=L.Polygon.extend({statics:{R:6378.137,M_PER_KM:1e3},initialize:function(a,b){this._centerLatLng=a,L.Util.setOptions(this,b),L.Polygon.prototype.initialize.call(this,this._getLatLngs(),b)},options:{fill:!0,radius:1e3,numberOfSides:4,rotation:0,maxDegrees:360},getLatLng:function(){return this._centerLatLng},setRadius:function(a){this.options.radius=a,this._latlngs=this._getLatLngs(),this.redraw()
},_getLatLngs:function(){for(var a,b=this.options.maxDegrees||360,c=b/Math.max(this.options.numberOfSides,3),d=b+this.options.rotation,e=this.options.rotation,f=[];d>e;)a=this._getPoint(e),f.push(a),e+=c;return f},_getPoint:function(a){var b=function(a){return a*L.LatLng.DEG_TO_RAD},c=function(a){return a*L.LatLng.RAD_TO_DEG},d=b(a),e=this.options.radius/L.RegularPolygon.M_PER_KM/L.RegularPolygon.R,f=b(this._centerLatLng.lat),g=b(this._centerLatLng.lng),h=Math.asin(Math.sin(f)*Math.cos(e)+Math.cos(f)*Math.sin(e)*Math.cos(d)),i=g+Math.atan2(Math.sin(d)*Math.sin(e)*Math.cos(f),Math.cos(e)-Math.sin(f)*Math.sin(h));return h=c(h),i=c(i),new L.LatLng(h,i)},toGeoJSON:function(){for(var a={type:"Feature",geometry:{type:"Polygon",coordinates:[[],[]]},properties:this.options},b=0;b<this._latlngs.length;++b){var c=this._latlngs[b];a.coordinates[0].push([c[1],c[0]])}return a}}),L.regularPolygon=function(a,b){return new L.RegularPolygon(a,b)},L.Path.XLINK_NS="http://www.w3.org/1999/xlink";var TextFunctions=TextFunctions||{__updatePath:L.Path.prototype._updatePath,_updatePath:function(){this.__updatePath.call(this),this.options.text&&this._createText(this.options.text)},_initText:function(){this.options.text&&this._createText(this.options.text)},getTextAnchor:function(){return this._point?this._point:void 0},setTextAnchor:function(a){this._text&&(this._text.setAttribute("x",a.x),this._text.setAttribute("y",a.y))},_createText:function(a){this._text&&this._container.removeChild(this._text),this._pathDef&&this._defs.removeChild(this._pathDef);var b=function(a,b){var c="";for(var d in b)c+=d+": "+b[d]+";";return a.setAttribute("style",c),a},c=function(a,b){for(var c in b)a.setAttribute(c,b[c]);return a};this._text=this._createElement("text");var d=document.createTextNode(a.text);if(a.path){var e=a.path,f=L.Util.guid(),g=this._createElement("path");g.setAttribute("d",this._path.getAttribute("d")),g.setAttribute("id",f),this._defs||(this._defs=this._createElement("defs"),this._container.appendChild(this._defs)),this._defs.appendChild(g),this._pathDef=g;var h=this._createElement("textPath");e.startOffset&&h.setAttribute("startOffset",e.startOffset),e.attr&&c(h,e.attr),e.style&&b(h,e.style),h.setAttributeNS(L.Path.XLINK_NS,"xlink:href","#"+f),h.appendChild(d),this._text.appendChild(h)}else{this._text.appendChild(d);var i=this.getTextAnchor();this.setTextAnchor(i)}a.className?this._text.setAttribute("class",a.className):this._text.setAttribute("class","leaflet-svg-text"),a.attr&&c(this._text,a.attr),a.style&&b(this._text,a.style),this._container.appendChild(this._text)}},PathFunctions=PathFunctions||{__updateStyle:L.Path.prototype._updateStyle,_createDefs:function(){this._defs=this._createElement("defs"),this._container.appendChild(this._defs)},_createGradient:function(a){this._defs||this._createDefs(),this._gradient&&this._defs.removeChild(this._gradient),a=a!==!0?L.extend({},a):{};var b=L.Util.guid();this._gradientGuid=b;var c,d;if("radial"==a.gradientType){c=this._createElement("radialGradient");var d=a.radial||{cx:"50%",cy:"50%",r:"50%",fx:"50%",fy:"50%"}}else{c=this._createElement("linearGradient");var e=a.vector||[["0%","0%"],["100%","100%"]],d={x1:e[0][0],x2:e[1][0],y1:e[0][1],y2:e[1][1]}}d.id="grad"+b;var f=a.stops||[{offset:"0%",style:{color:"rgb(255, 255, 255)",opacity:1}},{offset:"60%",style:{color:this.options.fillColor||this.options.color,opacity:1}}];for(var g in d)c.setAttribute(g,d[g]);for(var h=0;h<f.length;++h){var i=f[h],j=this._createElement("stop");i.style=i.style||{};for(var g in i){var k=i[g];if("style"===g){var l="";k.color=k.color||this.options.fillColor||this.options.color,k.opacity="undefined"==typeof k.opacity?1:k.opacity;for(var m in k)l+="stop-"+m+":"+k[m]+";";k=l}j.setAttribute(g,k)}c.appendChild(j)}this._gradient=c,this._defs.appendChild(c)},_createDropShadow:function(a){this._defs||this._createDefs(),this._dropShadow&&this._defs.removeChild(this._dropShadow);var b=L.Util.guid(),c=this._createElement("filter"),d=this._createElement("feOffset"),e=this._createElement("feGaussianBlur"),f=this._createElement("feBlend");a=a||{width:"200%",height:"200%"},a.id="filter"+b;for(var g in a)c.setAttribute(g,a[g]);var h={result:"offOut","in":"SourceAlpha",dx:"2",dy:"2"},i={result:"blurOut","in":"offOut",stdDeviation:"2"},j={"in":"SourceGraphic",in2:"blurOut",mode:"lighten"};for(var g in h)d.setAttribute(g,h[g]);for(var g in i)e.setAttribute(g,i[g]);for(var g in j)f.setAttribute(g,j[g]);c.appendChild(d),c.appendChild(e),c.appendChild(f),this._dropShadow=c,this._defs.appendChild(c)},_createCustomElement:function(a,b){var c=this._createElement(a);for(var d in b)b.hasOwnProperty(d)&&c.setAttribute(d,b[d]);return c},_createImage:function(a){var b=this._createElement("image");return b.setAttribute("width",a.width),b.setAttribute("height",a.height),b.setAttribute("x",a.x||0),b.setAttribute("y",a.y||0),b.setAttributeNS(L.Path.XLINK_NS,"xlink:href",a.url),b},_createPattern:function(a){this._pattern&&this._defs.removeChild(this._pattern);var b=this._createCustomElement("pattern",a);return this._pattern=b,b},_createShape:function(a,b){this._shape&&this._container.removeChild(this._shape);var c=this._createCustomElement(a,b);return c},_applyCustomStyles:function(){},_createFillPattern:function(a){var b=L.Util.guid(),c=a.pattern;c.id=b,c.patternUnits=c.patternUnits||"objectBoundingBox";var d=this._createPattern(c),e=this._createImage(a.image);e.setAttributeNS(L.Path.XLINK_NS,"xlink:href",a.url),d.appendChild(e),this._defs||this._createDefs(),this._defs.appendChild(d),this._path.setAttribute("fill","url(#"+b+")")},_getDefaultDiameter:function(a){return 1.75*a},_createShapeImage:function(a){a=a||{};var b=L.Util.guid(),c=this.options.radius||Math.max(this.options.radiusX,this.options.radiusY),d=this._getDefaultDiameter(c),e=a.imageSize||new L.Point(d,d),f=a.radius||d/2,g=a.shape||{circle:{r:f,cx:0,cy:0}},h=a.pattern||{width:e.x,height:e.y,x:0,y:0},i=Object.keys(g),j=i.length>0?i[0]:"circle";g[j].fill="url(#"+b+")";var k=this._createShape(j,g[j]);this.options.clickable&&k.setAttribute("class","leaflet-clickable"),h.id=b,h.patternUnits=h.patternUnits||"objectBoundingBox";var l=this._createPattern(h),a=a.image||{width:e.x,height:e.y,x:0,y:0,url:this.options.imageCircleUrl},m=this._createImage(a);m.setAttributeNS(L.Path.XLINK_NS,"xlink:href",a.url),l.appendChild(m),this._defs.appendChild(l),this._container.insertBefore(k,this._defs),this._shape=k;var n=this;this._shape.addEventListener("mouseover",function(){n.fire("mouseover")}),this._shape.addEventListener("mouseout",function(){n.fire("mouseout")}),this._shape.addEventListener("mousemove",function(){n.fire("mousemove")});var o=this.getTextAnchor();if(this._shape&&o)if("circle"===this._shape.tagName||"ellipse"===this._shape.tagName)this._shape.setAttribute("cx",o.x),this._shape.setAttribute("cy",o.y);else{var p=this._shape.getAttribute("width"),q=this._shape.getAttribute("height");this._shape.setAttribute("x",o.x-Number(p)/2),this._shape.setAttribute("y",o.y-Number(q)/2)}},_updateStyle:function(a){this.__updateStyle.call(this,a);var b=a?a:this;b.options.stroke&&(b.options.lineCap&&b._path.setAttribute("stroke-linecap",b.options.lineCap),b.options.lineJoin&&b._path.setAttribute("stroke-linejoin",b.options.lineJoin)),b.options.gradient?(b._createGradient(b.options.gradient),b._path.setAttribute("fill","url(#"+b._gradient.getAttribute("id")+")")):b.options.fill||b._path.setAttribute("fill","none"),b.options.dropShadow?(b._createDropShadow(),b._path.setAttribute("filter","url(#"+b._dropShadow.getAttribute("id")+")")):b._path.removeAttribute("filter"),b.options.fillPattern&&b._createFillPattern(b.options.fillPattern),b._applyCustomStyles()}};if(L.SVG){var SVGStyleFunctions=L.Util.extend(PathFunctions,{__updateStyle:L.SVG.prototype._updateStyle}),SVGTextFunctions=L.Util.extend(TextFunctions,{__updatePath:L.SVG.prototype._updatePath});L.SVG.include(SVGStyleFunctions),L.SVG.include(SVGTextFunctions)}var LineTextFunctions=L.extend({},TextFunctions);LineTextFunctions.__updatePath=L.Polyline.prototype._updatePath,LineTextFunctions.getCenter=function(){var a,b,c,d,e,f,g=this._latlngs,h=g.length;for(a=0,b=h-1,area=0,lat=0,lng=0;h>a;b=a++)c=g[a],d=g[b],e=c.lat*d.lng-d.lat*c.lng,lat+=(c.lat+d.lat)*e,lng+=(c.lng+d.lng)*e,area+=e/2;return f=area?new L.LatLng(lat/(6*area),lng/(6*area)):g[0],f.area=area,f},LineTextFunctions.getTextAnchor=function(){var a=this.getCenter();return this._map.latLngToLayerPoint(a)},L.Polyline.include(LineTextFunctions),L.CircleMarker.include(TextFunctions),L.Path.include(PathFunctions),L.Polygon.include(PathFunctions),L.Polyline.include(PathFunctions),L.CircleMarker.include(PathFunctions),L.CircleMarker=L.CircleMarker.extend({_applyCustomStyles:function(){(this.options.shapeImage||this.options.imageCircleUrl)&&this._createShapeImage(this.options.shapeImage)},getTextAnchor:function(){var a=null;return this._point&&(a=new L.Point(this._point.x,this._point.y)),a}}),L.Point.prototype.rotate=function(a,b){var c=this.distanceTo(b),d=a*L.LatLng.DEG_TO_RAD+Math.atan2(this.y-b.y,this.x-b.x);this.x=b.x+c*Math.cos(d),this.y=b.y+c*Math.sin(d)},L.MapMarker=L.Path.extend({includes:TextFunctions,initialize:function(a,b){L.Path.prototype.initialize.call(this,b),this._latlng=a},options:{fill:!0,fillOpacity:1,opacity:1,radius:15,innerRadius:5,position:{x:0,y:0},rotation:0,numberOfSides:50,color:"#000000",fillColor:"#0000FF",weight:1,gradient:!0,dropShadow:!0,clickable:!0},setLatLng:function(a){return this._latlng=a,this.redraw()},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints(),this.options.innerRadius>0&&(this._innerPoints=this._getPoints(!0).reverse())},getBounds:function(){var a=this._map,b=3*this.options.radius,c=a.project(this._latlng),d=new L.Point(c.x-this.options.radius,c.y),e=new L.Point(c.x+this.options.radius,c.y-b),f=a.unproject(d),g=a.unproject(e);return new L.LatLngBounds(f,g)},getLatLng:function(){return this._latlng},setRadius:function(a){return this.options.radius=a,this.redraw()},setInnerRadius:function(a){return this.options.innerRadius=a,this.redraw()},setRotation:function(a){return this.options.rotation=a,this.redraw()},setNumberOfSides:function(a){return this.options.numberOfSides=a,this.redraw()},getPathString:function(){var a=this.getTextAnchor();if(this._shape)if("circle"===this._shape.tagName||"ellipse"===this._shape.tagName)this._shape.setAttribute("cx",a.x),this._shape.setAttribute("cy",a.y);else{var b=this._shape.getAttribute("width"),c=this._shape.getAttribute("height");this._shape.setAttribute("x",a.x-Number(b)/2),this._shape.setAttribute("y",a.y-Number(c)/2)}return this._path.setAttribute("shape-rendering","geometricPrecision"),new L.SVGPathBuilder(this._points,this._innerPoints).build(6)},getTextAnchor:function(){var a=null;return this._point&&(a=new L.Point(this._point.x,this._point.y-2*this.options.radius)),a},_getPoints:function(a){var b,c,d=a?360:210,e=a?d/Math.max(this.options.numberOfSides,3):d/50,f=a?d+this.options.rotation:d,g=a?this.options.rotation:-30,h=[],i=this.options.radius,j=Math.sqrt(.75),k=function(a){return a*L.LatLng.DEG_TO_RAD},l=this._point;for(a||(h.push(l),h.push(new L.Point(l.x+j*i,l.y-1.5*i)));f>g;)c=k(g),b=this._getPoint(c,i,a),h.push(b),g+=e;return a||h.push(new L.Point(l.x-j*i,l.y-1.5*i)),h},_getPoint:function(a,b,c){var d=b;return b=c?this.options.innerRadius:b,new L.Point(this._point.x+this.options.position.x+b*Math.cos(a),this._point.y-2*d+this.options.position.y-b*Math.sin(a))},_applyCustomStyles:function(){(this.options.shapeImage||this.options.imageCircleUrl)&&this._createShapeImage(this.options.shapeImage)},toGeoJSON:function(){return L.Util.pointToGeoJSON.call(this)}}),L.mapMarker=function(a,b){return new L.MapMarker(a,b)},L.RegularPolygonMarker=L.Path.extend({includes:TextFunctions,initialize:function(a,b){L.Path.prototype.initialize?L.Path.prototype.initialize.call(this,b):L.setOptions(this,b),this._latlng=a,this.options.numberOfSides=Math.max(this.options.numberOfSides,3)},options:{fill:!0,radiusX:10,radiusY:10,rotation:0,numberOfSides:3,position:{x:0,y:0},maxDegrees:360,gradient:!0,dropShadow:!1,clickable:!0},setLatLng:function(a){return this._latlng=a,this.redraw()},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints(),(this.options.innerRadius||this.options.innerRadiusX&&this.options.innerRadiusY)&&(this._innerPoints=this._getPoints(!0).reverse())},getBounds:function(){var a=this._map,b=this.options.radius||this.options.radiusX,c=this.options.radius||this.options.radiusY,d=b*Math.cos(Math.PI/4),e=c*Math.sin(Math.PI/4),f=a.project(this._latlng),g=new L.Point(f.x-d,f.y+e),h=new L.Point(f.x+d,f.y-e),i=a.unproject(g),j=a.unproject(h);return new L.LatLngBounds(i,j)},setRadius:function(a){return this.options.radius=a,this.redraw()},setRadiusXY:function(a,b){return this.options.radius=null,this.options.radiusX=a,this.options.radiusY=b,this.redraw()},setInnerRadius:function(a){return this.options.innerRadius=a,this.redraw()},setInnerRadiusXY:function(a,b){return this.options.innerRadius=null,this.options.innerRadiusX=a,this.options.innerRadiusY=b,this.redraw()},setRotation:function(a){return this.options.rotation=a,this.redraw()},setNumberOfSides:function(a){return this.options.numberOfSides=a,this.redraw()},getLatLng:function(){return this._latlng},getPathString:function(){var a=this.getTextAnchor();if(this._shape)if("circle"===this._shape.tagName||"ellipse"===this._shape.tagName)this._shape.setAttribute("cx",a.x),this._shape.setAttribute("cy",a.y);else{var b=this._shape.getAttribute("width"),c=this._shape.getAttribute("height");this._shape.setAttribute("x",a.x-Number(b)/2),this._shape.setAttribute("y",a.y-Number(c)/2)}return this._path.setAttribute("shape-rendering","geometricPrecision"),new L.SVGPathBuilder(this._points,this._innerPoints).build(6)},_getPoints:function(a){for(var b,c,d=this.options.maxDegrees||360,e=d/Math.max(this.options.numberOfSides,3),f=d,g=0,h=[],i=a?this.options.innerRadius||this.options.innerRadiusX:this.options.radius||this.options.radiusX,j=a?this.options.innerRadius||this.options.innerRadiusY:this.options.radius||this.options.radiusY,k=function(a){return a*L.LatLng.DEG_TO_RAD};f>g;)c=k(g),b=this._getPoint(c,i,j),h.push(b),g+=e;return h},_getPoint:function(a,b,c){var d=this.options.position?this._point.add(new L.Point(this.options.position.x,this.options.position.y)):this._point,e=new L.Point(d.x+b*Math.cos(a),d.y+c*Math.sin(a));return e.rotate(this.options.rotation,d),e},_getDefaultDiameter:function(a){var b=Math.PI/this.options.numberOfSides,c=a*Math.cos(b);return 1.75*c},_applyCustomStyles:function(){(this.options.shapeImage||this.options.imageCircleUrl)&&this._createShapeImage(this.options.shapeImage)},toGeoJSON:function(){return L.Util.pointToGeoJSON.call(this)}}),L.regularPolygonMarker=function(a,b){return new L.RegularPolygonMarker(a,b)},L.StarMarker=L.RegularPolygonMarker.extend({options:{numberOfPoints:5,rotation:-15,maxDegrees:360,gradient:!0,dropShadow:!0},setNumberOfPoints:function(a){return this.options.numberOfPoints=a,this.redraw()},_getPoints:function(a){for(var b,c,d,e=this.options.maxDegrees||360,f=e/this.options.numberOfPoints,g=e,h=0,i=[],j=a?this.options.innerRadius||this.options.innerRadiusX:this.options.radius||this.options.radiusX,k=a?this.options.innerRadius||this.options.innerRadiusY:this.options.radius||this.options.radiusY,l=function(a){return a*L.LatLng.DEG_TO_RAD};g>h;)d=l(h),b=this._getPoint(d,j,k),c=this._getPoint(d+l(f)/2,j/2,k/2),i.push(b),i.push(c),h+=f;return i}}),L.starMarker=function(a,b){return new L.StarMarker(a,b)},L.TriangleMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:3,rotation:30,radius:5}}),L.triangleMarker=function(a,b){return new L.TriangleMarker(a,b)},L.DiamondMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:4,radiusX:5,radiusY:10}}),L.diamondMarker=function(a,b){return new L.DiamondMarker(a,b)},L.SquareMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:4,rotation:45,radius:5}}),L.squareMarker=function(a,b){return new L.SquareMarker(a,b)},L.PentagonMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:5,rotation:-18,radius:5}}),L.pentagonMarker=function(a,b){return new L.PentagonMarker(a,b)},L.HexagonMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:6,rotation:30,radius:5}}),L.hexagonMarker=function(a,b){return new L.HexagonMarker(a,b)},L.OctagonMarker=L.RegularPolygonMarker.extend({options:{numberOfSides:8,rotation:22.5,radius:5}}),L.octagonMarker=function(a,b){return new L.OctagonMarker(a,b)},L.SVGMarker=L.Path.extend({initialize:function(a,b){L.Path.prototype.initialize.call(this,b),this._svg=b.svg,0===this._svg.indexOf("<")&&(this._data=this._svg),this._latlng=a},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},setLatLng:function(a){this._latlng=a,this.redraw()},getLatLng:function(){return this._latlng},getPathString:function(){var a=this,b=function(){for(var b=a._path.parentNode;"g"!==b.nodeName.toLowerCase();)b=b.parentNode;a.options.clickable&&b.setAttribute("class","leaflet-clickable");var c=a._data,d="svg"===c.nodeName.toLowerCase()?c.cloneNode(!0):c.querySelector("svg").cloneNode(!0);a.options.setStyle&&a.options.setStyle.call(a,d);var e=d.getAttribute("width"),f=d.getAttribute("height"),g=e?e.replace("px",""):"100%",h=f?f.replace("px",""):"100%";"100%"===g&&(g=a.options.size.x,h=a.options.size.y,d.setAttribute("width",g+(-1!==String(g).indexOf("%")?"":"px")),d.setAttribute("height",h+(-1!==String(h).indexOf("%")?"":"px")));var i=a.options.size||new L.Point(g,h),j=new L.Point(i.x/g,i.y/h),k=b.getElementsByTagName("svg");k.length>0&&k[0].parentNode.removeChild(k[0]),b.appendChild(d);var l=[],m=a.options.anchor||new L.Point(-i.x/2,-i.y/2),n=a._point.x+m.x,o=a._point.y+m.y;l.push("translate("+n+" "+o+")"),l.push("scale("+j.x+" "+j.y+")"),a.options.rotation&&l.push("rotate("+a.options.rotation+" "+g/2+" "+h/2+")"),b.setAttribute("transform",l.join(" "))};if(this._data)b();else{var c=new XMLHttpRequest;c.onreadystatechange=function(){4==this.readyState&&200==this.status&&(a._data=this.responseXML,b())},c.open("GET",this._svg,!0),c.send(null)}},toGeoJSON:function(){return pointToGeoJSON.call(this)}}),L.MarkerGroup=L.FeatureGroup.extend({initialize:function(a,b){L.FeatureGroup.prototype.initialize.call(this,b),this.setLatLng(a)},setStyle:function(){return this},setLatLng:function(a){return this._latlng=a,this.eachLayer(function(b){b.setLatLng&&b.setLatLng(a)}),this},getLatLng:function(){return this._latlng},toGeoJSON:function(){var a={type:"FeatureCollection",features:[]},b=function(a){return function(b){a.features.push(L.Util.pointToGeoJSON.call(b))}};return this.eachLayer(b(a)),a}}),L.BarMarker=L.Path.extend({initialize:function(a,b){L.Path.prototype.initialize.call(this,b),this._latlng=a},options:{fill:!0,width:2,maxHeight:10,position:{x:0,y:0},weight:1,color:"#000",opacity:1,gradient:!0,dropShadow:!1,lineCap:"square",lineJoin:"miter"},setLatLng:function(a){return this._latlng=a,this.redraw()},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},getBounds:function(){var a=this._map,b=a.project(this._latlng),c=this.options.width/2,d=new L.Point(b.x-c,b.y),e=new L.Point(b.x+c,b.y-this.options.maxHeight),f=a.unproject(d),g=a.unproject(e);return new L.LatLngBounds(f,g)},getLatLng:function(){return this._latlng},getPathString:function(){return this._path.setAttribute("shape-rendering","crispEdges"),new L.SVGPathBuilder(this._points).build()},_getPoints:function(){var a,b,c,d,e=[],f=this._point.x+this.options.position.x,g=this._point.y+this.options.position.y,h=this.options.width/2,i=this.options.value/this.options.maxValue*this.options.maxHeight;return a=new L.Point(f+h,g),b=new L.Point(f+h,g-i),c=new L.Point(f-h,g-i),d=new L.Point(f-h,g),e=[a,b,c,d]}}),L.barMarker=function(a,b){return new L.BarMarker(a,b)},L.ChartMarker=L.FeatureGroup.extend({initialize:function(a,b){L.Util.setOptions(this,b),this._layers={},this._latlng=a,this._loadComponents()},setLatLng:function(a){return this._latlng=a,this.redraw()},getLatLng:function(){return this._latlng},_loadComponents:function(){},_highlight:function(a){return a.weight&&(a.weight*=2),a},_unhighlight:function(a){return a.weight&&(a.weight/=2),a},_bindMouseEvents:function(a){var b=this,c=this.options.tooltipOptions;a.on("mouseover",function(a){var d,e=this.options,f=e.key,g=e.value,h=a.layerPoint,i=h.x-this._point.x,j=h.y-this._point.y,k=e.iconSize,l=i,m=j,n=5;l=0>i?k.x-i+n:-i-n,m=0>j?k.y-j+n:-j-n,d=new L.Point(l,m);var o={},p=e.displayText?e.displayText(g):g;o[f]={name:e.displayName,value:p};var q=new L.LegendIcon(o,e,{className:"leaflet-div-icon",iconSize:c?c.iconSize:k,iconAnchor:d});e.marker=new L.Marker(b._latlng,{icon:q}),e=b._highlight(e),this.initialize(b._latlng,e),this.redraw(),this.setStyle(e),b.addLayer(e.marker)}),a.on("mouseout",function(){var a=this.options;a=b._unhighlight(a),this.initialize(b._latlng,a),this.redraw(),this.setStyle(a),b.removeLayer(a.marker)})},bindPopup:function(a,b){this.eachLayer(function(c){c.bindPopup(a,b)})},openPopup:function(a){for(var b in this._layers){var c=this._layers[b];a=a||this._latlng,c.openPopup(a);break}},closePopup:function(){for(var a in this._layers){var b=this._layers[a];latlng=latlng||this._latlng,b.closePopup();break}},redraw:function(){this.clearLayers(),this._loadComponents()},toGeoJSON:function(){return L.Util.pointToGeoJSON.call(this)}}),L.BarChartMarker=L.ChartMarker.extend({initialize:function(a,b){L.Util.setOptions(this,b),L.ChartMarker.prototype.initialize.call(this,a,b)},options:{weight:1,opacity:1,color:"#000",fill:!0,position:{x:0,y:0},width:10,offset:0,iconSize:new L.Point(50,40)},_loadComponents:function(){var a,b,c,d,e,f,g,h=this.options,i=Object.keys(this.options.data),j=i.length,k=this.options.width,l=this.options.offset||0,m=this.options.data,n=this.options.chartOptions;e=-(k*j+l*(j-1))/2+k/2,f=0;for(var o in m)a=m[o],g=n[o],b=g.minValue||0,c=g.maxValue||100,h.fillColor=g.fillColor||this.options.fillColor,h.value=a,h.minValue=b,h.maxValue=c,h.position={x:e,y:f},h.width=k,h.maxHeight=g.maxHeight||10,h.key=o,h.value=a,h.displayName=g.displayName,h.opacity=this.options.opacity||1,h.fillOpacity=this.options.fillOpacity||.7,h.weight=this.options.weight||1,h.color=g.color||this.options.color,h.displayText=g.displayText,d=new L.BarMarker(this._latlng,h),this._bindMouseEvents(d),this.addLayer(d),e+=k+l}}),L.RadialBarMarker=L.Path.extend({initialize:function(a,b){L.Path.prototype.initialize.call(this,b),this._latlng=a},options:{fill:!0,radius:10,rotation:0,numberOfSides:30,position:{x:0,y:0},gradient:!0,dropShadow:!1},setLatLng:function(a){return this._latlng=a,this.redraw()},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},getBounds:function(){var a=this._map,b=this.options.radiusX||this.options.radius,c=this.options.radiusY||this.options.radius,d=b*Math.cos(Math.PI/4),e=c*Math.sin(Math.PI/4),f=a.project(this._latlng),g=new L.Point(f.x-d,f.y+e),h=new L.Point(f.x+d,f.y-e),i=a.unproject(g),j=a.unproject(h);return new L.LatLngBounds(i,j)},getLatLng:function(){return this._latlng},getPathString:function(){var a=this.options.endAngle-this.options.startAngle,b=a>=180?"1":"0",c=this.options.radiusX||this.options.radius,d=this.options.radiusY||this.options.radius,e="M"+this._points[0].x.toFixed(2)+","+this._points[0].y.toFixed(2)+"A"+c.toFixed(2)+","+d.toFixed(2)+" 0 "+b+",1 "+this._points[1].x.toFixed(2)+","+this._points[1].y.toFixed(2)+"L";return this._innerPoints?(e=e+this._innerPoints[0].x.toFixed(2)+","+this._innerPoints[0].y.toFixed(2),e=e+"A"+(c-this.options.barThickness).toFixed(2)+","+(d-this.options.barThickness).toFixed(2)+" 0 "+b+",0 "+this._innerPoints[1].x.toFixed(2)+","+this._innerPoints[1].y.toFixed(2)+"z"):e=e+this._point.x.toFixed(2)+","+this._point.y.toFixed(2)+"z",L.Browser.vml&&(e=Core.SVG.path(e)),this._path.setAttribute("shape-rendering","geometricPrecision"),e},_getPoints:function(){var a=this.options.endAngle-this.options.startAngle,b=this.options.endAngle+this.options.rotation,c=this.options.startAngle+this.options.rotation,d=[],e="radiusX"in this.options?this.options.radiusX:this.options.radius,f="radiusY"in this.options?this.options.radiusY:this.options.radius,g=function(a){return a*L.LatLng.DEG_TO_RAD};360===a&&(b-=.1);var h=g(c),i=g(b);return d.push(this._getPoint(h,e,f)),d.push(this._getPoint(i,e,f)),this.options.barThickness&&(this._innerPoints=[],this._innerPoints.push(this._getPoint(i,e-this.options.barThickness,f-this.options.barThickness)),this._innerPoints.push(this._getPoint(h,e-this.options.barThickness,f-this.options.barThickness))),d},_getPoint:function(a,b,c){return new L.Point(this._point.x+this.options.position.x+b*Math.cos(a),this._point.y+this.options.position.y+c*Math.sin(a))}}),L.radialBarMarker=function(a,b){return new L.RadialBarMarker(a,b)},L.PieChartMarker=L.ChartMarker.extend({initialize:function(a,b){L.Util.setOptions(this,b),L.ChartMarker.prototype.initialize.call(this,a,b)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:50,mouseOverExaggeration:1.2,maxDegrees:360,iconSize:new L.Point(50,40)},_highlight:function(a){var b=a.radiusX,c=a.radiusY,d=a.barThickness;return a.oldBarThickness=d,a.oldRadiusX=b,a.oldRadiusY=c,a.radiusX*=a.mouseOverExaggeration,a.radiusY*=a.mouseOverExaggeration,a.barThickness=a.radiusX-b+d,a},_unhighlight:function(a){return a.radiusX=a.oldRadiusX,a.radiusY=a.oldRadiusY,a.barThickness=a.oldBarThickness,a},_loadComponents:function(){var a,b,c,d,e=0,f=0,g=0,h=this.options.maxDegrees||360,i=this.options.rotation,j=this.options,k=this.options.data,l=this.options.chartOptions,m=function(a,b){var c=0;return a[b]&&(c=parseFloat(a[b])),c};for(d in k)a=m(k,d),e+=a;if(e>0)for(d in k)a=parseFloat(k[d]),c=l[d],g=a/e,f=g*h,j.startAngle=i,j.endAngle=i+f,j.fillColor=c.fillColor,j.color=c.color||"#000",j.radiusX=this.options.radiusX||this.options.radius,j.radiusY=this.options.radiusY||this.options.radius,j.rotation=0,j.key=d,j.value=a,j.displayName=c.displayName,j.displayText=c.displayText,b=new L.RadialBarMarker(this._latlng,j),this._bindMouseEvents(b),i=j.endAngle,this.addLayer(b)}}),L.pieChartMarker=function(a,b){return new L.PieChartMarker(a,b)},L.CoxcombChartMarker=L.PieChartMarker.extend({statics:{SIZE_MODE_RADIUS:"radius",SIZE_MODE_AREA:"area"}}),L.CoxcombChartMarker=L.CoxcombChartMarker.extend({initialize:function(a,b){L.Util.setOptions(this,b),L.PieChartMarker.prototype.initialize.call(this,a,b)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:50,mouseOverExaggeration:1.2,maxDegrees:360,iconSize:new L.Point(50,40),sizeMode:L.CoxcombChartMarker.SIZE_MODE_AREA},_loadComponents:function(){var a,b,c,d,e,f=0,g=this.options.maxDegrees||360,h=this.options.rotation,i=this.options,j="radiusX"in this.options?this.options.radiusX:this.options.radius,k="radiusY"in this.options?this.options.radiusY:this.options.radius,l=Object.keys(this.options.data),m=l.length,n=this.options.data,o=this.options.chartOptions;f=g/m;for(var p in n){a=parseFloat(n[p]),e=o[p];var b=e.minValue||0,c=e.maxValue;if(this.options.sizeMode===L.CoxcombChartMarker.SIZE_MODE_RADIUS){var q=new L.LinearFunction(new L.Point(b,0),new L.Point(c,j)),r=new L.LinearFunction(new L.Point(b,0),new L.Point(c,k));i.radiusX=q.evaluate(a),i.radiusY=r.evaluate(a)}else{var s=Math.max(j,k),t=Math.PI*Math.pow(s,2)/m,u=new L.LinearFunction(new L.Point(b,0),new L.Point(c,t),{postProcess:function(a){return Math.sqrt(m*a/Math.PI)}});i.radiusX=u.evaluate(a),i.radiusY=i.radiusX}i.startAngle=h,i.endAngle=h+f,i.fillColor=e.fillColor,i.color=e.color||"#000",i.rotation=0,i.key=p,i.value=a,i.displayName=e.displayName,i.displayText=e.displayText,d=new L.RadialBarMarker(this._latlng,i),this._bindMouseEvents(d),h=i.endAngle,this.addLayer(d)}}}),L.coxcombChartMarker=function(a,b){return new L.CoxcombChartMarker(a,b)},L.RadialBarChartMarker=L.ChartMarker.extend({initialize:function(a,b){L.Util.setOptions(this,b),L.ChartMarker.prototype.initialize.call(this,a,b)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:0,numberOfSides:30,offset:2,barThickness:5,maxDegrees:360,iconSize:new L.Point(50,40)},_loadComponents:function(){var a,b,c,d,e,f=this.options.rotation,g=this.options.maxDegrees||360,h=this.options,i=this.options.radiusX||this.options.radius,j=this.options.radiusY||this.options.radius,k=this.options.data,l=this.options.chartOptions,m=this.options.barThickness||4,n=this.options.offset||2;for(var o in k){a=parseFloat(k[o]),e=l[o],b=e.minValue||0,c=e.maxValue||100;var p=new L.LinearFunction(new L.Point(b,0),new L.Point(c,g));f=p.evaluate(a),h.startAngle=this.options.rotation,h.endAngle=this.options.rotation+f,h.fillColor=e.fillColor,h.radiusX=i,h.radiusY=j,h.barThickness=m,h.rotation=0,h.key=o,h.value=a,h.displayName=e.displayName,h.displayText=e.displayText,h.weight=this.options.weight||1,d=new L.RadialBarMarker(this._latlng,h),this._bindMouseEvents(d),this.addLayer(d),i+=m+n,j+=m+n}}}),L.radialBarChartMarker=function(a,b){return new L.RadialBarChartMarker(a,b)},L.StackedRegularPolygonMarker=L.ChartMarker.extend({options:{iconSize:new L.Point(50,40)},initialize:function(a,b){L.Util.setOptions(this,b),L.ChartMarker.prototype.initialize.call(this,a,b)},_loadComponents:function(){var a,b,c,d,e=0,f=0,g=this.options,h=this.options.data,i=this.options.chartOptions,j=[];for(d in h){a=parseFloat(h[d]),c=i[d],minValue=c.minValue||0,maxValue=c.maxValue||100,minRadius=c.minRadius||0,maxRadius=c.maxRadius||10,g.fillColor=c.fillColor||this.options.fillColor,g.value=a,g.minValue=minValue,g.maxValue=maxValue;var k=new L.LinearFunction(new L.Point(minValue,minRadius),new L.Point(maxValue,maxRadius)),l=k.evaluate(a);g.radiusX=e+l,g.radiusY=f+l,g.innerRadiusX=e,g.innerRadiusY=f,g.key=d,g.displayName=c.displayName,g.opacity=this.options.opacity||1,g.fillOpacity=this.options.fillOpacity||.7,g.weight=this.options.weight||1,g.color=c.color||this.options.color,g.displayText=c.displayText,b=new L.RegularPolygonMarker(this._latlng,g),this._bindMouseEvents(b),e=g.radiusX,f=g.radiusY,this.options.drawReverse?j.push(b):this.addLayer(b)}if(this.options.drawReverse)for(var m=j.pop();m;)this.addLayer(m),m=j.pop()}}),L.RadialMeterMarker=L.ChartMarker.extend({initialize:function(a,b){L.Util.setOptions(this,b),L.ChartMarker.prototype.initialize.call(this,a,b)},options:{weight:1,opacity:1,color:"#000",fill:!0,radius:10,rotation:180,numberOfSides:30,offset:2,barThickness:5,maxDegrees:180,iconSize:new L.Point(50,40),backgroundStyle:{fill:!0,fillColor:"#707070",fillOpacity:.2,opacity:.8,color:"#505050"}},_loadComponents:function(){var a,b,c,d,e,f,g=this.options.rotation,h=this.options.maxDegrees||360,i=this.options,j=this.options.radiusX||this.options.radius,k=this.options.radiusY||this.options.radius,l=this.options.data,m=this.options.chartOptions,n=this.options.barThickness||4,o=g,p=this.options.numSegments||10,q=h/p;for(var r in l){a=parseFloat(l[r]),e=m[r],f=this.options.displayOptions?this.options.displayOptions[r]:{},b=e.minValue||0,c=e.maxValue||100;for(var s=c-b,t=h/s*(a-b),u=g+t,v=g+h,w=new L.LinearFunction(new L.Point(g,b),new L.Point(v,c));u>o;){i.startAngle=o;var x=Math.min(q,u-o);i.endAngle=o+x,i.fillColor=e.fillColor,i.radiusX=j,i.radiusY=k,i.barThickness=n,i.rotation=0,i.key=r,i.value=a,i.displayName=e.displayName,i.displayText=e.displayText;var y=w.evaluate(o+x);for(var z in f)i[z]=f[z].evaluate?f[z].evaluate(y):f[z];d=new L.RadialBarMarker(this._latlng,i),this._bindMouseEvents(d),this.addLayer(d),o+=x}if(this.options.backgroundStyle&&v>o){var x=v-o;i.endAngle=o+x,i.radiusX=j,i.radiusY=k,i.barThickness=n,i.rotation=0,i.key=r,i.value=a,i.displayName=e.displayName,i.displayText=e.displayText,i.fillColor=null,i.fill=!1,i.gradient=!1;
for(var A in this.options.backgroundStyle)i[A]=this.options.backgroundStyle[A];var y=w.evaluate(o+x);d=new L.RadialBarMarker(this._latlng,i),this.addLayer(d)}}}}),L.LocationModes={LATLNG:function(a,b){var c=function(b,c){var d=L.Util.getFieldValue(a,b),e=L.Util.getFieldValue(a,c),f=null;if(d&&e){var g=new L.LatLng(d,e);f={location:g,text:[g.lat.toFixed(3),g.lng.toFixed(3)].join(", "),center:g}}return f},d=c(this.options.latitudeField,this.options.longitudeField);if(!d&&this.options.fallbackLocationFields)for(var e,b=0;!d&&b<this.options.fallbackLocationFields.length;)e=this.options.fallbackLocationFields[b],d=c(e.latitudeField,e.longitudeField),b++;return d},GEOHASH:function(a,b){var c,d=this.options.geohashField?L.Util.getFieldValue(a,this.options.geohashField):b,e=decodeGeoHash(d);return e.latitude[2]&&e.longitude[2]&&(c=new L.LatLngBounds(new L.LatLng(e.latitude[0],e.longitude[0]),new L.LatLng(e.latitude[1],e.longitude[1]))),{location:c,text:d,center:c.getCenter()}},GWCOUNTRY:function(a,b){var c,d,e=this.options.codeField?L.Util.getFieldValue(a,this.options.codeField):b,f=L.gwNoLookup||{},g=L.countries||{},h=L.countryCentroids||{},i=e.toUpperCase();e=i;var j=i in f;j&&(e=f[i]||e),e?(c=g[e],d=h[e]):console.log("Code not found: "+i);var k=new L.GeoJSON(c);return{location:k,text:L.GeometryUtils.getName(c)||e,center:d}},COUNTRY:function(a,b){var c,d,e=this.options.codeField?L.Util.getFieldValue(a,this.options.codeField):b,f=L.codeLookup||{},g=L.alpha2Lookup||{},h=L.fips2Lookup||{},i=L.countries||{},j=L.countryCentroids||{},k=e.toUpperCase();e=k,2===e.length?e=g[k]||h[k]:3===e.length&&(e=f[k]||e),e?(c=i[e],d=j[e]):console.log("Code not found: "+k);var l=new L.GeoJSON(c);return{location:l,text:L.GeometryUtils.getName(c)||e,center:d}},STATE:function(a,b){var c,d,e=this.options.codeField?L.Util.getFieldValue(a,this.options.codeField):b,f=L.states||{},g=L.stateCentroids||{},h=e.toUpperCase();e=h,c=f[e],d=g[e];var i=new L.GeoJSON(c);return{location:i,text:L.GeometryUtils.getName(c)||e,center:d}},GEOJSON:function(a){var b=this.options.geoJSONField,c=b?L.Util.getFieldValue(a,b):a,d=null;if(c){var e=this,f=function(a,b){return e.recordToLayer(a,b)};d=L.GeometryUtils.getGeoJSONLocation(c,a,this.options.locationTextField,f)}return d},LOOKUP:function(a,b){var c=this.options.codeField?L.Util.getFieldValue(a,this.options.codeField):b;this._lookupIndex=this._lookupIndex||L.GeometryUtils.indexFeatureCollection(this.options.locationLookup,this.options.locationIndexField||this.options.codeField);var d=this._lookupIndex[c],e=null;if(d||0!==c.indexOf("0")||(d=this._lookupIndex[c.substring(1)]),d){var f=this,g=function(a,b){return f.recordToLayer(a,b)};e=L.GeometryUtils.getGeoJSONLocation(d,a,this.options.locationTextField,g)}return e},CUSTOM:function(a){var b,c=this.options.codeField,d=L.Util.getFieldValue(a,c),e={};if(e[d]=a,this.options.getLocation){var f=this,g=function(a,b){f.locationToLayer(b,e[a])};b=this.options.getLocation(e,c,[d],g)}return b}},L.DataLayer=L.LayerGroup.extend({includes:L.Mixin.Events,options:{recordsField:"features",locationMode:L.LocationModes.LATLNG,latitudeField:"geometry.coordinates.1",longitudeField:"geometry.coordinates.0",displayField:null,displayOptions:null,layerOptions:{numberOfSides:4,radius:10,weight:1,color:"#000"},showLegendTooltips:!0,tooltipOptions:{iconSize:new L.Point(60,50),iconAnchor:new L.Point(-5,50),mouseOverExaggeration:2},setHighlight:function(a){return a.weight=a.weight||1,a.fillOpacity=a.fillOpacity||.5,a.weight*=2,a.fillOpacity/=1.5,a},unsetHighlight:function(a){return a.weight=a.weight||1,a.fillOpacity=a.fillOpacity||.25,a.weight/=2,a.fillOpacity*=1.5,a}},initialize:function(a,b){L.Util.setOptions(this,b),L.LayerGroup.prototype.initialize.call(this,b),a=a||{},this._includeFunction=this.options.filter||this.options.includeLayer,this._markerFunction=this.options.getMarker||this._getMarker,this._addChildLayers(),this.addData(a)},_addChildLayers:function(){this._boundaryLayer=new L.LayerGroup,this.addLayer(this._boundaryLayer),this._trackLayer=new L.LayerGroup,this.addLayer(this._trackLayer)},_zoomFunction:function(){var a=this._map,b=this,c=a.getZoom();if(this.options.maxZoom&&c>this.options.maxZoom)this.hiddenLayers=[],this.eachLayer(function(c){b.hiddenLayers.push(c),a.removeLayer(c)});else if(this.hiddenLayers){for(;this.hiddenLayers.length>0;){var d=this.hiddenLayers.pop();a.addLayer(d),this.options.backgroundLayer&&d.bringToBack&&d.bringToBack()}this.hiddenLayers=null}},onAdd:function(a){L.LayerGroup.prototype.onAdd.call(this,a),a.on("zoomend",this._zoomFunction,this)},onRemove:function(a){L.LayerGroup.prototype.onRemove.call(this,a),a.off("zoomend",this._zoomFunction,this)},bringToBack:function(){this.invoke("bringToBack"),this._trackLayer&&this._trackLayer.invoke("bringToBack"),this._boundaryLayer&&this._boundaryLayer.invoke("bringToBack")},bringToFront:function(){this._boundaryLayer&&this._boundaryLayer.invoke("bringToFront"),this._trackLayer&&this._trackLayer.invoke("bringToFront"),this.invoke("bringToFront")},getBounds:function(){var a;return this.eachLayer(function(b){b.getBounds&&(a?a.extend(b.getBounds()):a=b.getBounds())}),a},_getLocation:function(a,b){return this.options.locationMode.call(this,a,b)},_processLocation:function(a){var b=a.center;return b},_styleBoundary:function(a,b,c){if(a.setStyle){var d;this.options.boundaryStyle instanceof Function&&(d=this.options.boundaryStyle.call(this,c,a)),d=d||this.options.boundaryStyle||L.extend({},b,{fillOpacity:.2,clickable:!1}),a.setStyle(d)}return a},_addBoundary:function(a,b,c){var d,e=a.location;return this.options.includeBoundary&&(e instanceof L.LatLngBounds&&(e=new L.Rectangle(e)),e=this._styleBoundary(e,b,c),this._boundaryLayer.addLayer(e),d=e),d},_getLayer:function(a,b,c){var d=this._addBoundary(a,b,c);a=this._processLocation(a);var e;return a&&(e=this._markerFunction.call(this,a,b,c),e.boundaryLayer=d),e},_getMarker:function(a,b){var c;return a&&(c=b.numberOfSides>=30&&!(b.innerRadius||b.innerRadiusX&&b.innerRadiusY)?new L.CircleMarker(a,b):new L.RegularPolygonMarker(a,b)),c},_preProcessRecords:function(a){return a},_shouldLoadRecord:function(a){return this._includeFunction?this._includeFunction.call(this,a):!0},_loadRecords:function(a){var b;a=this._preProcessRecords(a);for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];d=this.options.deriveProperties?this.options.deriveProperties(d):d;var e=this._shouldLoadRecord(d);e&&(b=this._getLocation(d,c),this.locationToLayer(b,d))}},_preloadLocations:function(a){var b=this.options.codeField,c=[],d={};for(var e in a)if(a.hasOwnProperty(e)){var f=a[e],g=L.Util.getFieldValue(f,b);d[g]=f,c.push(g)}if(this.options.getLocation){var h=this,i=function(a,b){h.locationToLayer(b,d[a])};this.options.getLocation(d,b,c,i)}},setDisplayOptions:function(a){return this.options.displayOptions=a,this.reloadData(),this},setDisplayOption:function(a,b){if(this.options.displayOptions=this.options.displayOptions||{},a in this.options.displayOptions){var c=this.options.displayOptions[a];this.options.displayOptions[a]=L.extend({},c,b)}else this.options.displayOptions[a]=b;return this.reloadData(),this},setFilter:function(a){return this.options.filter=a,this.reloadData(),this},setData:function(a){this._data=a,this.reloadData()},reloadData:function(){return this._layerIndex||(this.clearLayers(),this._addChildLayers()),this._data&&this.addData(this._data),this.fire("legendChanged",this),this},addData:function(a){var b=null!==this.options.recordsField&&this.options.recordsField.length>0?L.Util.getFieldValue(a,this.options.recordsField):a;this.options.getIndexKey&&!this._layerIndex&&(this._layerIndex={},this._boundaryIndex={}),this.options.locationMode===L.LocationModes.CUSTOM&&this.options.preload?this._preloadLocations(b):this._loadRecords(b),this._data=a},locationToLayer:function(a,b){var c;c=this.recordToLayer(a,b),c&&this.addLayer(c)},_bindMouseEvents:function(a,b,c){var d=this,e=this.options,f=e.setHighlight,g=e.unsetHighlight,h=e.tooltipOptions,i=function(a){var b=a.target,e=this.options||b.options,g=new L.LegendIcon(c,e,{className:h.className||"leaflet-div-icon",iconSize:h.iconSize,iconAnchor:h.iconAnchor}),i=a.latlng||a.target._latlng,j=new L.Marker(i,{icon:g});d.addLayer(j),d.tooltip&&(d.removeLayer(d.tooltip),d.tooltip=null),d.tooltip=j,f&&(e=f(e)),b.setStyle&&b.setStyle(e),b.isHighlighted=!0},j=function(a){d.tooltip&&d.tooltip.setLatLng(a.latlng)},k=function(a){if(a.target.isHighlighted){a.target.isHighlighted=!1,d.tooltip&&(d.removeLayer(d.tooltip),d.tooltip=null);var b=a.target,c=this.options||b.options;g&&(c=g(c)),b.setStyle&&b.setStyle(c)}},l=function(a){a.off("mouseover"),a.off("mouseout"),a.off("mousemove"),a.on({mouseover:i,mouseout:k,mousemove:j})},m=function(a){a.eachLayer?a.eachLayer(function(a){m(a)}):l(a)};m(a)},_getDynamicOptions:function(a){var b=L.Util.extend({},this.options.layerOptions),c=this.options.displayOptions,d={};if(c)for(var e in c){var f,g=c[e],h=L.Util.getFieldValue(a,e),i=g.displayText?g.displayText(h):h;if(d[e]={name:g.displayName,value:i},g.styles)b=L.Util.extend(b,g.styles[h]),g.styles[h]=b;else for(var j in g)f=g[j],b[j]=f.evaluate?f.evaluate(h):f.call?f.call(this,h):f}return{layerOptions:b,legendDetails:d}},_getIndexedLayer:function(a,b,c,d){if(this.options.getIndexKey){var e=this.options.getIndexKey.call(this,b,d);if(e in a){layer=a[e];var f=function(a){c.radius&&a instanceof L.CircleMarker&&a.setRadius(c.radius),a.setStyle(c),a.setLatLng&&a.getLatLng()!==b.center?a.setLatLng(b.center):a.redraw()};L.Util.updateLayer(layer,f),layer.boundaryLayer&&(layer.boundaryLayer=this._styleBoundary(layer.boundaryLayer,c,d))}else layer=this._getLayer(b,c,d),a[e]=layer;if(this.options.getTrack){var g=!layer.trackLayer;layer.trackLayer=this.options.getTrack.call(this,layer,b,layer.trackLayer),g&&this._trackLayer.addLayer(layer.trackLayer)}}else layer=this._getLayer(b,c,d);return layer},recordToLayer:function(a,b){var c,d=L.Util.extend({},this.options.layerOptions),e={},f=!0;if(this._includeFunction&&(f=this._includeFunction.call(this,b)),f){var g=this._getDynamicOptions(b);d=g.layerOptions,e=g.legendDetails,a&&d&&(d.title=a.text,c=this._getIndexedLayer(this._layerIndex,a,d,b),c&&(this.options.showLegendTooltips&&this._bindMouseEvents(c,d,e),this.options.onEachRecord&&this.options.onEachRecord.call(this,c,b,a,this)))}return c},getLegend:function(a){return this.options.getLegend?this.options.getLegend.call(this,a):this._getLegend(a)},_getLegendElement:function(a){var b,c,d=document.createElement("i"),e=a.displayProperties,f=a.layerOptions,g=a.ignoreProperties,h=a.displayTextFunction,i=a.index,j=a.numSegments,k=a.segmentWidth,l=a.minValue,m=a.maxValue;L.StyleConverter.applySVGStyle(d,f);for(var n in e)if(-1===g.indexOf(n)&&(valueFunction=e[n],valueFunction&&(valueFunction.getBounds||e.minValue&&e.maxValue))){var o=valueFunction.getBounds?valueFunction.getBounds():null,p=o?o[0].x:e.minValue,q=o?o[1].x:e.maxValue,r=new L.LinearFunction(new L.Point(0,p),new L.Point(j,q));b=p,c=q,h&&(b=h(p),c=h(q)),0===i&&(l.innerHTML=b,m.innerHTML=c);var s=(q-p)/j,t=r.evaluate(i),u=r.evaluate(i+1),v=valueFunction.evaluate?valueFunction.evaluate(t):valueFunction(t),w=valueFunction.evaluate?valueFunction.evaluate(u):valueFunction(u);L.StyleConverter.setCSSProperty(d,n,v),"fillColor"===n&&(d.style.cssText+=a.gradient?"background-image:linear-gradient(left , "+v+" 0%, "+w+" 100%);background-image:-ms-linear-gradient(left , "+v+" 0%, "+w+" 100%);background-image:-moz-linear-gradient(left , "+v+" 0%, "+w+" 100%);background-image:-webkit-linear-gradient(left , "+v+" 0%, "+w+" 100%);":"background-color:"+w+";"),"color"===n&&(d.style.cssText+="border-top-color:"+v+";border-bottom-color:"+w+";border-left-color:"+v+";border-right-color:"+w+";"),"weight"===n&&(d.style.cssText+="border-top-width:"+v+";border-bottom-width:"+w+";border-left-width:"+v+";border-right-width:"+w+";");var x=s*i+p,y=x+s;h&&valueFunction&&(x=h(x),y=h(y)),d.setAttribute("title",x+" - "+y)}return d.style.width=k+"px",d},_getLegend:function(a){a=a||this.options.legendOptions||{};var b,c=a.className,d=document.createElement("div"),e=L.DomUtil.create("div","legend",d),f=a.numSegments||10,g=a.width||100,h=this.options.layerOptions||{},i=h.weight||0,j=g/f-2*i,k=this.options.displayOptions||{};c&&L.DomUtil.addClass(e,c),a.title&&(L.DomUtil.create("legend","",e).innerHTML=a.title);var l=function(a){return a};for(var m in k){var n=k[m];if(!n.excludeFromLegend){var o=n.displayName||m;b=n.displayText;var p=b?b:l,q=n.styles;if(L.DomUtil.create("div","legend-title",e).innerHTML=o,q)e.innerHTML+=new L.CategoryLegend(q).generate();else{for(var r=L.DomUtil.create("div","data-layer-legend"),s=L.DomUtil.create("div","min-value",r),t=L.DomUtil.create("div","scale-bars",r),u=L.DomUtil.create("div","max-value",r),v=["displayName","displayText","minValue","maxValue"],w=0;f>w;++w){var x={displayProperties:n,layerOptions:h,ignoreProperties:v,displayTextFunction:p,index:w,numSegments:f,segmentWidth:j,minValue:s,maxValue:u,gradient:a.gradient},y=this._getLegendElement(x);t.appendChild(y)}e.appendChild(r)}}}return d.innerHTML}}),L.dataLayer=function(a,b){return new L.DataLayer(a,b)},L.MapMarkerDataLayer=L.DataLayer.extend({_getMarker:function(a,b){return new L.MapMarker(a,b)}}),L.mapMarkerDataLayer=function(a,b){return new L.MapMarkerDataLayer(a,b)},L.MarkerDataLayer=L.DataLayer.extend({initialize:function(a,b){this._markerMap={},L.DataLayer.prototype.initialize.call(this,a,b)},options:{recordsField:"features",locationMode:L.LocationModes.LATLNG,latitudeField:"latitude",longitudeField:"longitude",layerOptions:{icon:null},showLegendTooltips:!1},_getMarker:function(a,b,c){return this.options.setIcon&&(b.icon=this.options.setIcon.call(this,c,b)),new L.Marker(a,b)},_getLegendElement:function(){},_getLegend:function(){return"<span>No legend available</span>"}}),L.markerDataLayer=function(a,b){return new L.MarkerDataLayer(a,b)},L.PanoramioLayer=L.MarkerDataLayer.extend({statics:{UPLOAD_DATE_FORMAT:"DD MMM YYYY",SIZE_BY_DATE:"date",SIZE_BY_POPULARITY:"popularity",SIZE_BY_NONE:"none",SIZES:{square:[60,60],mini_square:[32,32]},NUM_PHOTOS:50}}),L.PanoramioLayer=L.PanoramioLayer.extend({initialize:function(a){L.MarkerDataLayer.prototype.initialize.call(this,{},a),this._from=0,this._to=L.PanoramioLayer.NUM_PHOTOS,this._calls=[]},options:{recordsField:"photos",latitudeField:"latitude",longitudeField:"longitude",locationMode:L.LocationModes.LATLNG,showLegendTooltips:!1,sizeBy:L.PanoramioLayer.SIZE_BY_DATE,layerOptions:{opacity:1},onEachRecord:function(a,b){var c=b.photo_file_url,d=b.photo_title,e=this,f=b.width,g=b.height,h=2e4;a.on("click",function(i){var j=document.createElement("div"),k=L.DomUtil.create("div","",j),l=L.DomUtil.create("img","photo",k);l.setAttribute("onload","this.style.opacity=1;"),l.setAttribute("src",c),l.style.width=f+"px";var m=L.DomUtil.create("div","photo-info",k);m.style.width=f-20+"px",m.innerHTML="<span>"+d+'</span><a class="photo-link" target="_blank" href="'+b.photo_url+'"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 14px;"/></a>';var n=L.DomUtil.create("a","author-link",k);n.setAttribute("target","_blank"),n.setAttribute("href",b.owner_url),n.innerHTML="by "+b.owner_name;var o=new L.DivIcon({className:"photo-details",html:j.innerHTML,iconAnchor:[f/2,g/2]}),p=new L.Marker(i.target._latlng,{icon:o,zIndexOffset:h});p.on("click",function(a){e.removeLayer(a.target)}),a.viewedImage=p,e.viewedImage=p,e.addLayer(p)}),this.options.onEachPhoto&&this.options.onEachPhoto.call(this,a,b)},setIcon:function(a){var b=L.Util.getFieldValue(a,"photo_title"),c=null;this._sizeFunction&&(c=this._sizeFunction.evaluate(a.index));var d=c?new L.Point(c,c):L.PanoramioLayer.SIZES[this.options.size],e=a.photo_file_url.replace("/medium/","/"+this.options.size+"/"),f=new L.DivIcon({iconSize:d,className:"",html:'<img class="photo" onload="this.style.opacity=1" title="'+b+'" src="'+e+'"/>'});return f},updateInterval:3e5,size:"square",attributionText:'Photos provided by <a href="http://www.panoramio.com"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 10px;"/></a>.  Photos provided by <a href="http://www.panoramio.com"><img src="http://www.panoramio.com/img/glass/components/logo_bar/panoramio.png" style="height: 10px;"/></a> are under the copyright of their owners',refreshEvents:"moveend",photoSet:"public"},includes:L.Mixin.Events,onAdd:function(a){L.DataLayer.prototype.onAdd.call(this,a),a.attributionControl&&a.attributionControl.addAttribution(this.options.attributionText);var b=this,c=function(){b._from=0,b._to=L.PanoramioLayer.NUM_PHOTOS,b.fire("requestingPhotos"),b._call&&clearTimeout(b._call);var a=function(){b.requestPhotos()};b._call=setTimeout(a,1e3)};this.requestPhotos(),this._interval=setInterval(c,this.options.updateInterval),this._resetFunction=c,a.on(this.options.refreshEvents,c)},onRemove:function(a){L.DataLayer.prototype.onRemove.call(this,a),a.attributionControl&&a.attributionControl.removeAttribution(this.options.attributionText),this._interval&&(clearInterval(this._interval),this._interval=null),a.off(this.options.refreshEvents,this._resetFunction)},calculateSizeByDate:function(a){for(var b=a.photos,c=[],d=0;d<b.length;++d){var e=b[d],f=moment(e.upload_date,L.PanoramioLayer.UPLOAD_DATE_FORMAT);c.push(f),b[d].index=f}c.sort(function(a,b){return a-b});var g=L.PanoramioLayer.SIZES[this.options.size][0];return this._sizeFunction=new L.LinearFunction([c[0],g/2],[c[c.length-1],g]),a},calculateSizeByPopularity:function(a){for(var b=a.photos,c=0;c<b.length;++c)b[c].index=c;var d=L.PanoramioLayer.SIZES[this.options.size][0];return this._sizeFunction=new L.LinearFunction([0,d/2],[b.length,d]),a},next:function(){this._from=this._to,this._to=this._from+L.PanoramioLayer.NUM_PHOTOS,this.requestPhotos()},previous:function(){this._to=this._from,this._from=this._from-L.PanoramioLayer.NUM_PHOTOS,this.requestPhotos()},requestJsonp:function(a,b,c){var d=this,e="function"+(new Date).getTime(),f=[];b.callback="window.LeafletDvfJsonpCallbacks."+e;for(property in b)b.hasOwnProperty(property)&&f.push(property+"="+encodeURIComponent(b[property]));return a+=(a.indexOf("?")>0?"&":"?")+f.join("&"),"undefined"==typeof window.LeafletDvfJsonpCallbacks&&(window.LeafletDvfJsonpCallbacks={}),window.LeafletDvfJsonpCallbacks[e]=function(a){c.call(d,a),delete window.LeafletDvfJsonpCallbacks[e]},this.jsonpScript&&(document.head.removeChild(this.jsonpScript),this.jsonpScript=null),this.jsonpScript=document.createElement("script"),this.jsonpScript.setAttribute("type","text/javascript"),this.jsonpScript.setAttribute("async","true"),this.jsonpScript.setAttribute("src",a),document.head.appendChild(this.jsonpScript),{abort:function(){e in window.LeafletDvfJsonpCallbacks&&(window.LeafletDvfJsonpCallbacks[e]=function(){delete window.LeafletDvfJsonpCallbacks[e]})}}},requestPhotos:function(){for(var a=this,b=this._map.getBounds(),c=b.getSouthWest(),d=b.getNorthEast();a._calls.length>0;)a._calls.pop().abort();var e=this.requestJsonp("http://www.panoramio.com/map/get_panoramas.php",{set:this.options.photoSet,from:a._from,to:a._to,minx:c.lng,miny:c.lat,maxx:d.lng,maxy:d.lat,size:"medium",mapfilter:"true"},function(b){a._count=b.count,moment&&a.options.sizeBy===L.PanoramioLayer.SIZE_BY_DATE?b=a.calculateSizeByDate(b):a.options.sizeBy===L.PanoramioLayer.SIZE_BY_POPULARITY&&(b=a.calculateSizeByPopularity(b)),a.fire("photosAvailable",b),a.clearLayers(),a.addData(b)});a._calls.push(e)}}),L.panoramioLayer=function(a){return new L.PanoramioLayer(a)},L.GeohashDataLayer=L.DataLayer.extend({initialize:function(a,b){L.DataLayer.prototype.initialize.call(this,a,b)},options:{recordsField:"features",locationMode:L.LocationModes.GEOHASH,geohashField:"geohash",displayField:null,displayOptions:null,layerOptions:{weight:1,color:"#000"},getIndexKey:function(a){return a.text}},_getLayer:function(a,b){return new L.Rectangle(a.location,b)}}),L.geohashDataLayer=function(a,b){return new L.GeohashDataLayer(a,b)},L.ChoroplethDataLayer=L.DataLayer.extend({initialize:function(a,b){L.DataLayer.prototype.initialize.call(this,a,b)},options:{recordsField:"features",locationMode:L.LocationModes.COUNTRY,codeField:"ISO",displayField:null,displayOptions:null,layerOptions:{weight:1,color:"#000"},maxZoom:16,backgroundLayer:!0},_getLayer:function(a,b,c){return a.location instanceof L.LatLng&&(a.location=this._markerFunction.call(this,a.location,b,c)),a.location.setStyle&&(b.gradient=a.location instanceof L.Polyline?!1:b.gradient,a.location.setStyle(b)),a.location}}),L.choroplethDataLayer=function(a,b){return new L.ChoroplethDataLayer(a,b)},L.ChartDataLayer=L.DataLayer.extend({options:{showLegendTooltips:!1},initialize:function(a,b){L.DataLayer.prototype.initialize.call(this,a,b)},_getLayer:function(a,b,c){var d=this._addBoundary(a,b,c);a=this._processLocation(a);var e=this.options.chartOptions,f=this.options.tooltipOptions,g={};g=b,g.data={},g.chartOptions=e;for(var h in this.options.chartOptions)g.data[h]=this.options.getFieldValue?this.options.getFieldValue.call(this,c,h):L.Util.getFieldValue(c,h);for(var h in f)g[h]=f[h];var i;return a&&(i=this._getMarker(a,g),i.boundaryLayer=d),i},_getMarker:function(){},_getLegend:function(a){var b=(L.DataLayer.prototype._getLegend.call(this,a),new L.CategoryLegend(this.options.chartOptions));return a=a||this.options.legendOptions,b.generate(a)}}),L.BarChartDataLayer=L.ChartDataLayer.extend({initialize:function(a,b){L.ChartDataLayer.prototype.initialize.call(this,a,b)},_getMarker:function(a,b){return new L.BarChartMarker(a,b)}}),L.barChartDataLayer=function(a,b){return new L.BarChartDataLayer(a,b)},L.RadialBarChartDataLayer=L.ChartDataLayer.extend({initialize:function(a,b){L.ChartDataLayer.prototype.initialize.call(this,a,b)},_getMarker:function(a,b){return new L.RadialBarChartMarker(a,b)}}),L.radialBarChartDataLayer=function(a,b){return new L.RadialBarChartDataLayer(a,b)},L.PieChartDataLayer=L.ChartDataLayer.extend({initialize:function(a,b){L.ChartDataLayer.prototype.initialize.call(this,a,b)},_getMarker:function(a,b){return new L.PieChartMarker(a,b)}}),L.pieChartDataLayer=function(a,b){return new L.PieChartDataLayer(a,b)},L.CoxcombChartDataLayer=L.ChartDataLayer.extend({initialize:function(a,b){L.ChartDataLayer.prototype.initialize.call(this,a,b)},_getMarker:function(a,b){return new L.CoxcombChartMarker(a,b)}}),L.coxcombChartDataLayer=function(a,b){return new L.CoxcombChartDataLayer(a,b)},L.StackedRegularPolygonDataLayer=L.ChartDataLayer.extend({initialize:function(a,b){L.ChartDataLayer.prototype.initialize.call(this,a,b)},_getMarker:function(a,b){return new L.StackedRegularPolygonMarker(a,b)}}),L.stackedRegularPolygonDataLayer=function(a,b){return new L.StackedRegularPolygonDataLayer(a,b)},L.StackedPieChartDataLayer=L.ChartDataLayer.extend({initialize:function(a,b){L.ChartDataLayer.prototype.initialize.call(this,a,b)},_getMarker:function(a,b){return new L.StackedPieChartMarker(a,b)}}),L.stackedPieChartDataLayer=function(a,b){return new L.StackedPieChartDataLayer(a,b)},L.RadialMeterMarkerDataLayer=L.DataLayer.extend({options:{showLegendTooltips:!1},initialize:function(a,b){L.DataLayer.prototype.initialize.call(this,a,b)},_getLayer:function(a,b,c){this._addBoundary(a,b),a=this._processLocation(a);var d=this.options.chartOptions,e=this.options.tooltipOptions,f=this.options.displayOptions,g={};g=b,g.data={},g.chartOptions=d,g.displayOptions=f;for(var h in this.options.chartOptions)g.data[h]=L.Util.getFieldValue(c,h);for(var h in e)g[h]=e[h];var i;return a&&(i=this._getMarker(a,g)),i},_getMarker:function(a,b){return new L.RadialMeterMarker(a,b)}}),L.radialMeterMarkerDataLayer=function(a,b){return new L.RadialMeterMarkerDataLayer(a,b)},L.CalloutLine=L.Path.extend({statics:{LINESTYLE:{ARC:"arc",ANGLE:"angle",STRAIGHT:"straight"},DIRECTION:{NE:"ne",NW:"nw",SE:"se",SW:"sw"}}}),L.CalloutLine=L.CalloutLine.extend({initialize:function(a,b){L.Util.setOptions(this,b),L.Path.prototype.initialize.call(this,b),this._latlng=a},options:{size:new L.Point(60,30),position:new L.Point(0,0),color:"#FFFFFF",opacity:1,weight:2,fillColor:"#000000",fill:!1,gradient:!1,dropShadow:!1,direction:L.CalloutLine.DIRECTION.NE,lineStyle:L.CalloutLine.LINESTYLE.ANGLE,lineCap:"butt",lineJoin:"miter",arrow:!1},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._points=this._getPoints()},getEndPoint:function(){return this.projectLatlngs(),this._points[this._points.length-1]},_getPathAngle:function(){return new L.SVGPathBuilder(this._points,[],{closePath:!1}).build(6)},_getPathArc:function(){var a=(this.options.direction||L.CalloutLine.DIRECTION.NE).toLowerCase(),b=a[0],c="n"===b?-1:1,d=this._points[0],e=this._points[this._points.length-1],f=["M",d.x,",",d.y," Q",d.x,",",d.y+c*this.options.size.y," ",e.x,",",e.y];return f.join(" ")},_getPoints:function(){var a=this._point.x+this.options.position.x,b=this._point.y+this.options.position.y,c=this.options.size.x,d=this.options.size.y,e=(this.options.direction||L.CalloutLine.DIRECTION.NE).toLowerCase(),f=[],g=e[1],h=e[0],i="w"===g?-1:1,j="n"===h?-1:1;f.push(new L.Point(a,b));var k=b+j*d,l=c/2,m=Math.atan(d/l);if(this.options.lineStyle===L.CalloutLine.LINESTYLE.ARC?m=Math.atan(Math.pow(d,2)/l):this.options.lineStyle===L.CalloutLine.LINESTYLE.STRAIGHT&&(m=Math.atan(d/c)),this._angle=m,this.options.lineStyle!==L.CalloutLine.LINESTYLE.STRAIGHT){var n=new L.Point(a+i*l,k);f.push(n)}var o=new L.Point(a+i*c,k);return f.push(o),f},getBounds:function(){var a=this._map,b=a.project(this._latlng),c=new L.Point(b.x+this.options.position.x,b.y+this.options.position.y),d=new L.Point(c.x+this.options.size.x,c.y-this.options.size.y),e=a.unproject(c),f=a.unproject(d);return new L.LatLngBounds(e,f)},setLatLng:function(a){this._latlng=a,this.redraw()},getLatLng:function(){return this._latlng},getPathString:function(){this._path.setAttribute("shape-rendering","geometricPrecision");var a=this.options.lineStyle||L.CalloutLine.LINESTYLE.ANGLE,b="";return b+=a===L.CalloutLine.LINESTYLE.ANGLE||a===L.CalloutLine.LINESTYLE.STRAIGHT?this._getPathAngle():this._getPathArc()}}),L.calloutLine=function(a,b){return new L.CalloutLine(a,b)},L.Callout=L.LayerGroup.extend({options:{color:"#FFFFFF",fillColor:"#FFFFFF"},initialize:function(a,b){L.Util.setOptions(this,b),L.LayerGroup.prototype.initialize.call(this,b),this._latlng=a},onAdd:function(a){L.LayerGroup.prototype.onAdd.call(this,a),this.addLayers()},onRemove:function(a){L.LayerGroup.prototype.onRemove.call(this,a),this.clearLayers()},addArrow:function(a,b,c){if(this.options.arrow){var a=L.LatLng.RAD_TO_DEG*a,d=this.options.numberOfSides||3,e=this.options.radius||6,f=180/d,g={se:f+a,sw:180+f-a,nw:180+f+a,ne:f-a},h=g[b],i=new L.RegularPolygonMarker(this._latlng,{position:c,numberOfSides:d,rotation:h,fillColor:this.options.fillColor,color:this.options.color,gradient:this.options.gradient,weight:this.options.weight,opacity:this.options.opacity,fillOpacity:this.options.fillOpacity,radius:e,lineCap:"butt",lineJoin:"miter"});this.addLayer(i)}},addLine:function(){var a={};for(var b in this.options)"icon"!==b&&(a[b]=this.options[b]);var c=new L.CalloutLine(this._latlng,a);return this.addLayer(c),c},addIcon:function(a,b){var c=this.options.size,d=this.options.icon,e=d.options.iconSize,f=a[0],g=a[1],h="w"===g?e.x+c.x-b.x:-1*(c.x+b.x),i="n"===f?e.y/2+c.y-b.y:-1*(-e.y/2+c.y+b.y);d.options.iconAnchor=new L.Point(h,i);var j=new L.Marker(this._latlng,{icon:d});this.addLayer(j)},addLayers:function(){var a,b=(this.options.direction||"ne").toLowerCase(),c=this.options.position||new L.Point(0,0);a=this.addLine(),this.addIcon(b,c),this.addArrow(a._angle,b,c)}}),L.callout=function(a,b){return new L.Callout(a,b)},L.FlowLine=L.DataLayer.extend({statics:{LINE_FUNCTION:function(a,b,c){return new L.Polyline([a,b],c)},LINE_FUNCTION_INTERPOLATED:function(a,b,c){{var d=this._map.latlngToLayerPoint(a),e=this._map.latlngToLayerPoint(b),f=new L.LinearFunction(d,e),g=Math.ceil(d.distanceTo(e)/c.interpolationOptions.segmentLength);f.samplePoints(g)}}}}),L.FlowLine=L.FlowLine.extend({initialize:function(a,b){L.Util.setOptions(this,b),L.DataLayer.prototype.initialize.call(this,a,b)},options:{getLine:L.FlowLine.LINE_FUNCTION},onEachSegment:function(a,b,c){var d={};if(this.options.timeField){var e=L.Util.getFieldValue(a,this.options.timeField),f=L.Util.getFieldValue(b,this.options.timeField),g=this.options.timeFormat,h=g?moment(e,g):moment(e),i=g?moment(f,g):moment(f),j=i.valueOf()-h.valueOf();d.time=j}for(var k in this.options.displayOptions){var l=L.Util.getFieldValue(a,k),m=L.Util.getFieldValue(b,k),n=m-l,o=n/l*100;d[k]={from:l,to:m,change:n,percentChange:o},d.time&&(d[k].changeOverTime=n/d.time)}var p,q=c.getLatLngs(),r=q[0].distanceTo(q[1]);d.time&&(p=r/(1e3*d.time)),this.options.onEachSegment&&this.options.onEachSegment.call(this,a,b,c,d,r,p)},_loadRecords:function(a){var b=[];this._lastRecord=null;for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];b=this._addRecord(d,c,b)}for(;b.length>0;)this.addLayer(b.pop())},addRecord:function(a){return this._addRecord(a),this},_addRecord:function(a,b,c){var d=this._getLocation(a,b),e=this.options.layerOptions;if(d){var f,g=this._getLayer(d,e,a),h=!0;if(this.options.includeLayer&&(h=this.options.includeLayer(a)),this._lastRecord&&h){var e=this._getDynamicOptions(this._lastRecord);f=this.options.getLine.call(this,this._lastMarker.getLatLng(),g.getLatLng(),e.layerOptions),this.addLayer(f),this.onEachSegment(this._lastRecord,a,f)}h&&(this._lastRecord=a,this._lastMarker=g)}return c}}),L.flowLine=function(a,b){return new L.FlowLine(a,b)},L.ArcedFlowLine=L.FlowLine.extend({options:{getLine:function(a,b,c){return new L.ArcedPolyline([a,b],c)}},initialize:function(a,b){L.FlowLine.prototype.initialize.call(this,a,b)}}),L.arcedFlowLine=function(a,b){return new L.ArcedFlowLine(a,b)},L.ArcedPolyline=L.Path.extend({includes:TextFunctions,initialize:function(a,b){L.Path.prototype.initialize.call(this,b),this._latlngs=a},options:{distanceToHeight:new L.LinearFunction([0,5],[1e3,200]),color:"#FFFFFF",opacity:1,weight:1,fillColor:"#000000",fill:!1,gradient:!1,dropShadow:!1,optimizeSpeed:!1},projectLatlngs:function(){this._points=[];for(var a=0;a<this._latlngs.length;++a)this._points.push(this._map.latLngToLayerPoint(this._latlngs[a]))},getBounds:function(){for(var a=new L.LatLngBounds,b=0;b<this._latlngs.length;++b)a.extend(this._latlngs[b]);return a},setLatLngs:function(a){this._latlngs=a,this.redraw()},getLatLngs:function(){return this._latlngs},drawSegment:function(a,b){var c=Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2)),d=this.options.distanceToHeight.evaluate(c),e=["M",a.x,",",a.y," C",a.x,",",a.y-d," ",b.x,",",b.y-d," ",b.x,",",b.y];return e.join(" ")},getPathString:function(){this.options.optimizeSpeed&&this._path.setAttribute("shape-rendering","optimizeSpeed");for(var a=[],b=0;b<this._points.length-1;++b)a.push(this.drawSegment(this._points[b],this._points[b+1]));return a.join("")}}),L.arcedPolyline=function(a,b){return new L.ArcedPolyline(a,b)},L.Control.Legend=L.Control.extend({options:{position:"bottomright",autoAdd:!0},onAdd:function(a){var b="leaflet-control-legend",c=L.DomUtil.create("div",b),d=this;return this.options.autoAdd&&(a.on("layeradd",function(a){var b=a.layer;d.addLayer(b)}),a.on("layerremove",function(a){var b=a.layer;d.removeLayer(b)})),this.toggleSize=L.bind(this.toggleSize,this),L.DomEvent.addListener(c,"mouseover",this.toggleSize).addListener(c,"mouseout",this.toggleSize).addListener(c,"touchstart",this.toggleSize).addListener(c,"touchend",this.toggleSize).addListener(c,"click",L.DomEvent.stopPropagation).addListener(c,"click",L.DomEvent.preventDefault),c},clear:function(){this._container.innerHTML=""},toggleSize:function(){L.DomUtil.hasClass(this._container,"larger")?L.DomUtil.removeClass(this._container,"larger"):L.DomUtil.addClass(this._container,"larger")},redrawLayer:function(a){this.removeLayer(a),this.addLayer(a)
},addLayer:function(a){var b=L.Util.stamp(a),c=this;a.getLegend&&(this.addLegend(b,a.getLegend()),a.on("legendChanged",function(){c.redrawLayer(a)}))},removeLayer:function(a){var b=L.Util.stamp(a);if(a.getLegend){var c=document.getElementById(b);c.parentNode.removeChild(c),a.off("legendChanged")}},addLegend:function(a,b){var c=this._container,d=document.getElementById(a);d||(d=L.DomUtil.create("div","",c),d.id=a),d.innerHTML=b}}),L.control.legend=function(a){return new L.Control.Legend(a)},!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b(require,exports,module):a.Tether=b()}(this,function(){return function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r={}.hasOwnProperty,s=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},t=[].slice;null==this.Tether&&(this.Tether={modules:[]}),k=function(a){var b,c,d,e,f;if(c=getComputedStyle(a).position,"fixed"===c)return a;for(d=void 0,b=a;b=b.parentNode;){try{e=getComputedStyle(b)}catch(g){}if(null==e)return b;if(/(auto|scroll)/.test(e.overflow+e["overflow-y"]+e["overflow-x"])&&("absolute"!==c||"relative"===(f=e.position)||"absolute"===f||"fixed"===f))return b}return document.body},o=function(){var a;return a=0,function(){return a++}}(),q={},i=function(a){var b,d,f,g,h;if(f=a._tetherZeroElement,null==f&&(f=a.createElement("div"),f.setAttribute("data-tether-id",o()),e(f.style,{top:0,left:0,position:"absolute"}),a.body.appendChild(f),a._tetherZeroElement=f),b=f.getAttribute("data-tether-id"),null==q[b]){q[b]={},h=f.getBoundingClientRect();for(d in h)g=h[d],q[b][d]=g;c(function(){return q[b]=void 0})}return q[b]},m=null,g=function(a){var b,c,d,e,f,g,h;a===document?(c=document,a=document.documentElement):c=a.ownerDocument,d=c.documentElement,b={},h=a.getBoundingClientRect();for(e in h)g=h[e],b[e]=g;return f=i(c),b.top-=f.top,b.left-=f.left,null==b.width&&(b.width=document.body.scrollWidth-b.left-b.right),null==b.height&&(b.height=document.body.scrollHeight-b.top-b.bottom),b.top=b.top-d.clientTop,b.left=b.left-d.clientLeft,b.right=c.body.clientWidth-b.width-b.left,b.bottom=c.body.clientHeight-b.height-b.top,b},h=function(a){return a.offsetParent||document.documentElement},j=function(){var a,b,c,d,f;return a=document.createElement("div"),a.style.width="100%",a.style.height="200px",b=document.createElement("div"),e(b.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),b.appendChild(a),document.body.appendChild(b),d=a.offsetWidth,b.style.overflow="scroll",f=a.offsetWidth,d===f&&(f=b.clientWidth),document.body.removeChild(b),c=d-f,{width:c,height:c}},e=function(a){var b,c,d,e,f,g,h;for(null==a&&(a={}),b=[],Array.prototype.push.apply(b,arguments),h=b.slice(1),f=0,g=h.length;g>f;f++)if(d=h[f])for(c in d)r.call(d,c)&&(e=d[c],a[c]=e);return a},n=function(a,b){var c,d,e,f,g;if(null!=a.classList){for(f=b.split(" "),g=[],d=0,e=f.length;e>d;d++)c=f[d],c.trim()&&g.push(a.classList.remove(c));return g}return a.className=a.className.replace(new RegExp("(^| )"+b.split(" ").join("|")+"( |$)","gi")," ")},b=function(a,b){var c,d,e,f,g;if(null!=a.classList){for(f=b.split(" "),g=[],d=0,e=f.length;e>d;d++)c=f[d],c.trim()&&g.push(a.classList.add(c));return g}return n(a,b),a.className+=" "+b},l=function(a,b){return null!=a.classList?a.classList.contains(b):new RegExp("(^| )"+b+"( |$)","gi").test(a.className)},p=function(a,c,d){var e,f,g,h,i,j;for(f=0,h=d.length;h>f;f++)e=d[f],s.call(c,e)<0&&l(a,e)&&n(a,e);for(j=[],g=0,i=c.length;i>g;g++)e=c[g],j.push(l(a,e)?void 0:b(a,e));return j},d=[],c=function(a){return d.push(a)},f=function(){var a,b;for(b=[];a=d.pop();)b.push(a());return b},a=function(){function a(){}return a.prototype.on=function(a,b,c,d){var e;return null==d&&(d=!1),null==this.bindings&&(this.bindings={}),null==(e=this.bindings)[a]&&(e[a]=[]),this.bindings[a].push({handler:b,ctx:c,once:d})},a.prototype.once=function(a,b,c){return this.on(a,b,c,!0)},a.prototype.off=function(a,b){var c,d,e;if(null!=(null!=(d=this.bindings)?d[a]:void 0)){if(null==b)return delete this.bindings[a];for(c=0,e=[];c<this.bindings[a].length;)e.push(this.bindings[a][c].handler===b?this.bindings[a].splice(c,1):c++);return e}},a.prototype.trigger=function(){var a,b,c,d,e,f,g,h,i;if(c=arguments[0],a=2<=arguments.length?t.call(arguments,1):[],null!=(g=this.bindings)?g[c]:void 0){for(e=0,i=[];e<this.bindings[c].length;)h=this.bindings[c][e],d=h.handler,b=h.ctx,f=h.once,d.apply(null!=b?b:this,a),i.push(f?this.bindings[c].splice(e,1):e++);return i}},a}(),this.Tether.Utils={getScrollParent:k,getBounds:g,getOffsetParent:h,extend:e,addClass:b,removeClass:n,hasClass:l,updateClasses:p,defer:c,flush:f,uniqueId:o,Evented:a,getScrollBarSize:j}}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=[].slice,E=function(a,b){return function(){return a.apply(b,arguments)}};if(null==this.Tether)throw new Error("You must include the utils.js file before tether.js");d=this.Tether,C=d.Utils,p=C.getScrollParent,q=C.getSize,n=C.getOuterSize,l=C.getBounds,m=C.getOffsetParent,j=C.extend,e=C.addClass,w=C.removeClass,z=C.updateClasses,i=C.defer,k=C.flush,o=C.getScrollBarSize,A=function(a,b,c){return null==c&&(c=1),a+c>=b&&b>=a-c},y=function(){var a,b,c,d,e;for(a=document.createElement("div"),e=["transform","webkitTransform","OTransform","MozTransform","msTransform"],c=0,d=e.length;d>c;c++)if(b=e[c],void 0!==a.style[b])return b}(),x=[],v=function(){var a,b,c;for(b=0,c=x.length;c>b;b++)a=x[b],a.position(!1);return k()},r=function(){var a;return null!=(a="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance.now():void 0)?a:+new Date},function(){var a,b,c,d,e,f,g,h,i;for(b=null,c=null,d=null,e=function(){return null!=c&&c>16?(c=Math.min(c-16,250),void(d=setTimeout(e,250))):null!=b&&r()-b<10?void 0:(null!=d&&(clearTimeout(d),d=null),b=r(),v(),c=r()-b)},h=["resize","scroll","touchmove"],i=[],f=0,g=h.length;g>f;f++)a=h[f],i.push(window.addEventListener(a,e));return i}(),a={center:"center",left:"right",right:"left"},b={middle:"middle",top:"bottom",bottom:"top"},c={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},h=function(c,d){var e,f;return e=c.left,f=c.top,"auto"===e&&(e=a[d.left]),"auto"===f&&(f=b[d.top]),{left:e,top:f}},g=function(a){var b,d;return{left:null!=(b=c[a.left])?b:a.left,top:null!=(d=c[a.top])?d:a.top}},f=function(){var a,b,c,d,e,f,g;for(b=1<=arguments.length?D.call(arguments,0):[],c={top:0,left:0},e=0,f=b.length;f>e;e++)g=b[e],d=g.top,a=g.left,"string"==typeof d&&(d=parseFloat(d,10)),"string"==typeof a&&(a=parseFloat(a,10)),c.top+=d,c.left+=a;return c},s=function(a,b){return"string"==typeof a.left&&-1!==a.left.indexOf("%")&&(a.left=parseFloat(a.left,10)/100*b.width),"string"==typeof a.top&&-1!==a.top.indexOf("%")&&(a.top=parseFloat(a.top,10)/100*b.height),a},t=u=function(a){var b,c,d;return d=a.split(" "),c=d[0],b=d[1],{top:c,left:b}},B=function(){function a(a){this.position=E(this.position,this);var b,c,e,f,g;for(x.push(this),this.history=[],this.setOptions(a,!1),f=d.modules,c=0,e=f.length;e>c;c++)b=f[c],null!=(g=b.initialize)&&g.call(this);this.position()}return a.modules=[],a.prototype.getClass=function(a){var b,c;return(null!=(b=this.options.classes)?b[a]:void 0)?this.options.classes[a]:(null!=(c=this.options.classes)?c[a]:void 0)!==!1?this.options.classPrefix?""+this.options.classPrefix+"-"+a:a:""},a.prototype.setOptions=function(a,b){var c,d,f,g,h,i;for(this.options=a,null==b&&(b=!0),c={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"},this.options=j(c,this.options),h=this.options,this.element=h.element,this.target=h.target,this.targetModifier=h.targetModifier,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),i=["element","target"],f=0,g=i.length;g>f;f++){if(d=i[f],null==this[d])throw new Error("Tether Error: Both element and target must be defined");null!=this[d].jquery?this[d]=this[d][0]:"string"==typeof this[d]&&(this[d]=document.querySelector(this[d]))}if(e(this.element,this.getClass("element")),e(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");return this.targetAttachment=t(this.options.targetAttachment),this.attachment=t(this.options.attachment),this.offset=u(this.options.offset),this.targetOffset=u(this.options.targetOffset),null!=this.scrollParent&&this.disable(),this.scrollParent="scroll-handle"===this.targetModifier?this.target:p(this.target),this.options.enabled!==!1?this.enable(b):void 0},a.prototype.getTargetBounds=function(){var a,b,c,d,e,f,g,h,i;if(null==this.targetModifier)return l(this.target);switch(this.targetModifier){case"visible":return this.target===document.body?{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth}:(a=l(this.target),e={height:a.height,width:a.width,top:a.top,left:a.left},e.height=Math.min(e.height,a.height-(pageYOffset-a.top)),e.height=Math.min(e.height,a.height-(a.top+a.height-(pageYOffset+innerHeight))),e.height=Math.min(innerHeight,e.height),e.height-=2,e.width=Math.min(e.width,a.width-(pageXOffset-a.left)),e.width=Math.min(e.width,a.width-(a.left+a.width-(pageXOffset+innerWidth))),e.width=Math.min(innerWidth,e.width),e.width-=2,e.top<pageYOffset&&(e.top=pageYOffset),e.left<pageXOffset&&(e.left=pageXOffset),e);case"scroll-handle":return i=this.target,i===document.body?(i=document.documentElement,a={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):a=l(i),h=getComputedStyle(i),c=i.scrollWidth>i.clientWidth||"scroll"===[h.overflow,h.overflowX]||this.target!==document.body,f=0,c&&(f=15),d=a.height-parseFloat(h.borderTopWidth)-parseFloat(h.borderBottomWidth)-f,e={width:15,height:.975*d*(d/i.scrollHeight),left:a.left+a.width-parseFloat(h.borderLeftWidth)-15},b=0,408>d&&this.target===document.body&&(b=-11e-5*Math.pow(d,2)-.00727*d+22.58),this.target!==document.body&&(e.height=Math.max(e.height,24)),g=this.target.scrollTop/(i.scrollHeight-d),e.top=g*(d-e.height-b)+a.top+parseFloat(h.borderTopWidth),this.target===document.body&&(e.height=Math.max(e.height,24)),e}},a.prototype.clearCache=function(){return this._cache={}},a.prototype.cache=function(a,b){return null==this._cache&&(this._cache={}),null==this._cache[a]&&(this._cache[a]=b.call(this)),this._cache[a]},a.prototype.enable=function(a){return null==a&&(a=!0),e(this.target,this.getClass("enabled")),e(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParent!==document&&this.scrollParent.addEventListener("scroll",this.position),a?this.position():void 0},a.prototype.disable=function(){return w(this.target,this.getClass("enabled")),w(this.element,this.getClass("enabled")),this.enabled=!1,null!=this.scrollParent?this.scrollParent.removeEventListener("scroll",this.position):void 0},a.prototype.destroy=function(){var a,b,c,d,e;for(this.disable(),e=[],a=c=0,d=x.length;d>c;a=++c){if(b=x[a],b===this){x.splice(a,1);break}e.push(void 0)}return e},a.prototype.updateAttachClasses=function(a,b){var c,d,e,f,g,h,j,k,l,m=this;for(null==a&&(a=this.attachment),null==b&&(b=this.targetAttachment),f=["left","top","bottom","right","middle","center"],(null!=(l=this._addAttachClasses)?l.length:void 0)&&this._addAttachClasses.splice(0,this._addAttachClasses.length),c=null!=this._addAttachClasses?this._addAttachClasses:this._addAttachClasses=[],a.top&&c.push(""+this.getClass("element-attached")+"-"+a.top),a.left&&c.push(""+this.getClass("element-attached")+"-"+a.left),b.top&&c.push(""+this.getClass("target-attached")+"-"+b.top),b.left&&c.push(""+this.getClass("target-attached")+"-"+b.left),d=[],g=0,j=f.length;j>g;g++)e=f[g],d.push(""+this.getClass("element-attached")+"-"+e);for(h=0,k=f.length;k>h;h++)e=f[h],d.push(""+this.getClass("target-attached")+"-"+e);return i(function(){return null!=m._addAttachClasses?(z(m.element,m._addAttachClasses,d),z(m.target,m._addAttachClasses,d),m._addAttachClasses=void 0):void 0})},a.prototype.position=function(a){var b,c,e,i,j,n,p,q,r,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T=this;if(null==a&&(a=!0),this.enabled){for(this.clearCache(),D=h(this.targetAttachment,this.attachment),this.updateAttachClasses(this.attachment,D),b=this.cache("element-bounds",function(){return l(T.element)}),I=b.width,e=b.height,0===I&&0===e&&null!=this.lastSize?(N=this.lastSize,I=N.width,e=N.height):this.lastSize={width:I,height:e},G=F=this.cache("target-bounds",function(){return T.getTargetBounds()}),r=s(g(this.attachment),{width:I,height:e}),E=s(g(D),G),j=s(this.offset,{width:I,height:e}),n=s(this.targetOffset,G),r=f(r,j),E=f(E,n),i=F.left+E.left-r.left,H=F.top+E.top-r.top,O=d.modules,J=0,L=O.length;L>J;J++)if(p=O[J],y=p.position.call(this,{left:i,top:H,targetAttachment:D,targetPos:F,attachment:this.attachment,elementPos:b,offset:r,targetOffset:E,manualOffset:j,manualTargetOffset:n,scrollbarSize:B}),null!=y&&"object"==typeof y){if(y===!1)return!1;H=y.top,i=y.left}if(q={page:{top:H,left:i},viewport:{top:H-pageYOffset,bottom:pageYOffset-H-e+innerHeight,left:i-pageXOffset,right:pageXOffset-i-I+innerWidth}},document.body.scrollWidth>window.innerWidth&&(B=this.cache("scrollbar-size",o),q.viewport.bottom-=B.height),document.body.scrollHeight>window.innerHeight&&(B=this.cache("scrollbar-size",o),q.viewport.right-=B.width),(""!==(P=document.body.style.position)&&"static"!==P||""!==(Q=document.body.parentElement.style.position)&&"static"!==Q)&&(q.page.bottom=document.body.scrollHeight-H-e,q.page.right=document.body.scrollWidth-i-I),(null!=(R=this.options.optimizations)?R.moveElement:void 0)!==!1&&null==this.targetModifier){for(u=this.cache("target-offsetparent",function(){return m(T.target)}),x=this.cache("target-offsetparent-bounds",function(){return l(u)}),w=getComputedStyle(u),c=getComputedStyle(this.element),v=x,t={},S=["Top","Left","Bottom","Right"],K=0,M=S.length;M>K;K++)C=S[K],t[C.toLowerCase()]=parseFloat(w["border"+C+"Width"]);x.right=document.body.scrollWidth-x.left-v.width+t.right,x.bottom=document.body.scrollHeight-x.top-v.height+t.bottom,q.page.top>=x.top+t.top&&q.page.bottom>=x.bottom&&q.page.left>=x.left+t.left&&q.page.right>=x.right&&(A=u.scrollTop,z=u.scrollLeft,q.offset={top:q.page.top-x.top+A-t.top,left:q.page.left-x.left+z-t.left})}return this.move(q),this.history.unshift(q),this.history.length>3&&this.history.pop(),a&&k(),!0}},a.prototype.move=function(a){var b,c,d,e,f,g,h,k,l,n,o,p,q,r,s,t,u,v=this;if(null!=this.element.parentNode){k={};for(n in a){k[n]={};for(e in a[n]){for(d=!1,t=this.history,r=0,s=t.length;s>r;r++)if(h=t[r],!A(null!=(u=h[n])?u[e]:void 0,a[n][e])){d=!0;break}d||(k[n][e]=!0)}}b={top:"",left:"",right:"",bottom:""},l=function(a,c){var d,e,f;return(null!=(f=v.options.optimizations)?f.gpu:void 0)===!1?(a.top?b.top=""+c.top+"px":b.bottom=""+c.bottom+"px",a.left?b.left=""+c.left+"px":b.right=""+c.right+"px"):(a.top?(b.top=0,e=c.top):(b.bottom=0,e=-c.bottom),a.left?(b.left=0,d=c.left):(b.right=0,d=-c.right),b[y]="translateX("+Math.round(d)+"px) translateY("+Math.round(e)+"px)","msTransform"!==y?b[y]+=" translateZ(0)":void 0)},f=!1,(k.page.top||k.page.bottom)&&(k.page.left||k.page.right)?(b.position="absolute",l(k.page,a.page)):(k.viewport.top||k.viewport.bottom)&&(k.viewport.left||k.viewport.right)?(b.position="fixed",l(k.viewport,a.viewport)):null!=k.offset&&k.offset.top&&k.offset.left?(b.position="absolute",g=this.cache("target-offsetparent",function(){return m(v.target)}),m(this.element)!==g&&i(function(){return v.element.parentNode.removeChild(v.element),g.appendChild(v.element)}),l(k.offset,a.offset),f=!0):(b.position="absolute",l({top:!0,left:!0},a.page)),f||"BODY"===this.element.parentNode.tagName||(this.element.parentNode.removeChild(this.element),document.body.appendChild(this.element)),q={},p=!1;for(e in b)o=b[e],c=this.element.style[e],""===c||""===o||"top"!==e&&"left"!==e&&"bottom"!==e&&"right"!==e||(c=parseFloat(c),o=parseFloat(o)),c!==o&&(p=!0,q[e]=b[e]);return p?i(function(){return j(v.element.style,q)}):void 0}},a}(),d.position=v,this.Tether=j(B,d)}.call(this),function(){var a,b,c,d,e,f,g,h,i,j,k=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1};j=this.Tether.Utils,g=j.getOuterSize,f=j.getBounds,h=j.getSize,d=j.extend,i=j.updateClasses,c=j.defer,b={left:"right",right:"left",top:"bottom",bottom:"top",middle:"middle"},a=["left","top","right","bottom"],e=function(b,c){var d,e,g,h,i,j,k;if("scrollParent"===c?c=b.scrollParent:"window"===c&&(c=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),c===document&&(c=c.documentElement),null!=c.nodeType)for(e=h=f(c),i=getComputedStyle(c),c=[e.left,e.top,h.width+e.left,h.height+e.top],d=j=0,k=a.length;k>j;d=++j)g=a[d],g=g[0].toUpperCase()+g.substr(1),"Top"===g||"Left"===g?c[d]+=parseFloat(i["border"+g+"Width"]):c[d]-=parseFloat(i["border"+g+"Width"]);return c},this.Tether.modules.push({position:function(b){var g,h,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb=this;if(H=b.top,s=b.left,C=b.targetAttachment,!this.options.constraints)return!0;for(z=function(b){var c,d,e,f;for(bb.removeClass(b),f=[],d=0,e=a.length;e>d;d++)c=a[d],f.push(bb.removeClass(""+b+"-"+c));return f},V=this.cache("element-bounds",function(){return f(bb.element)}),r=V.height,I=V.width,0===I&&0===r&&null!=this.lastSize&&(W=this.lastSize,I=W.width,r=W.height),E=this.cache("target-bounds",function(){return bb.getTargetBounds()}),D=E.height,F=E.width,B={},q={},h=[this.getClass("pinned"),this.getClass("out-of-bounds")],X=this.options.constraints,J=0,N=X.length;N>J;J++)p=X[J],p.outOfBoundsClass&&h.push(p.outOfBoundsClass),p.pinnedClass&&h.push(p.pinnedClass);for(K=0,O=h.length;O>K;K++)for(o=h[K],Y=["left","top","right","bottom"],L=0,P=Y.length;P>L;L++)A=Y[L],h.push(""+o+"-"+A);for(g=[],B=d({},C),q=d({},this.attachment),Z=this.options.constraints,M=0,Q=Z.length;Q>M;M++){if(p=Z[M],G=p.to,j=p.attachment,w=p.pin,null==j&&(j=""),k.call(j," ")>=0?($=j.split(" "),n=$[0],m=$[1]):m=n=j,l=e(this,G),("target"===n||"both"===n)&&(H<l[1]&&"top"===B.top&&(H+=D,B.top="bottom"),H+r>l[3]&&"bottom"===B.top&&(H-=D,B.top="top")),"together"===n&&(H<l[1]&&"top"===B.top&&("bottom"===q.top?(H+=D,B.top="bottom",H+=r,q.top="top"):"top"===q.top&&(H+=D,B.top="bottom",H-=r,q.top="bottom")),H+r>l[3]&&"bottom"===B.top&&("top"===q.top?(H-=D,B.top="top",H-=r,q.top="bottom"):"bottom"===q.top&&(H-=D,B.top="top",H+=r,q.top="top")),"middle"===B.top&&(H+r>l[3]&&"top"===q.top?(H-=r,q.top="bottom"):H<l[1]&&"bottom"===q.top&&(H+=r,q.top="top"))),("target"===m||"both"===m)&&(s<l[0]&&"left"===B.left&&(s+=F,B.left="right"),s+I>l[2]&&"right"===B.left&&(s-=F,B.left="left")),"together"===m&&(s<l[0]&&"left"===B.left?"right"===q.left?(s+=F,B.left="right",s+=I,q.left="left"):"left"===q.left&&(s+=F,B.left="right",s-=I,q.left="right"):s+I>l[2]&&"right"===B.left?"left"===q.left?(s-=F,B.left="left",s-=I,q.left="right"):"right"===q.left&&(s-=F,B.left="left",s+=I,q.left="left"):"center"===B.left&&(s+I>l[2]&&"left"===q.left?(s-=I,q.left="right"):s<l[0]&&"right"===q.left&&(s+=I,q.left="left"))),("element"===n||"both"===n)&&(H<l[1]&&"bottom"===q.top&&(H+=r,q.top="top"),H+r>l[3]&&"top"===q.top&&(H-=r,q.top="bottom")),("element"===m||"both"===m)&&(s<l[0]&&"right"===q.left&&(s+=I,q.left="left"),s+I>l[2]&&"left"===q.left&&(s-=I,q.left="right")),"string"==typeof w?w=function(){var a,b,c,d;for(c=w.split(","),d=[],b=0,a=c.length;a>b;b++)v=c[b],d.push(v.trim());return d}():w===!0&&(w=["top","left","right","bottom"]),w||(w=[]),x=[],t=[],H<l[1]&&(k.call(w,"top")>=0?(H=l[1],x.push("top")):t.push("top")),H+r>l[3]&&(k.call(w,"bottom")>=0?(H=l[3]-r,x.push("bottom")):t.push("bottom")),s<l[0]&&(k.call(w,"left")>=0?(s=l[0],x.push("left")):t.push("left")),s+I>l[2]&&(k.call(w,"right")>=0?(s=l[2]-I,x.push("right")):t.push("right")),x.length)for(y=null!=(_=this.options.pinnedClass)?_:this.getClass("pinned"),g.push(y),T=0,R=x.length;R>T;T++)A=x[T],g.push(""+y+"-"+A);if(t.length)for(u=null!=(ab=this.options.outOfBoundsClass)?ab:this.getClass("out-of-bounds"),g.push(u),U=0,S=t.length;S>U;U++)A=t[U],g.push(""+u+"-"+A);(k.call(x,"left")>=0||k.call(x,"right")>=0)&&(q.left=B.left=!1),(k.call(x,"top")>=0||k.call(x,"bottom")>=0)&&(q.top=B.top=!1),(B.top!==C.top||B.left!==C.left||q.top!==this.attachment.top||q.left!==this.attachment.left)&&this.updateAttachClasses(q,B)}return c(function(){return i(bb.target,g,h),i(bb.element,g,h)}),{top:H,left:s}}})}.call(this),function(){var a,b,c,d;d=this.Tether.Utils,b=d.getBounds,c=d.updateClasses,a=d.defer,this.Tether.modules.push({position:function(d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=this;if(o=d.top,j=d.left,y=this.cache("element-bounds",function(){return b(D.element)}),i=y.height,p=y.width,n=this.getTargetBounds(),h=o+i,k=j+p,e=[],o<=n.bottom&&h>=n.top)for(z=["left","right"],q=0,u=z.length;u>q;q++)l=z[q],((A=n[l])===j||A===k)&&e.push(l);if(j<=n.right&&k>=n.left)for(B=["top","bottom"],r=0,v=B.length;v>r;r++)l=B[r],((C=n[l])===o||C===h)&&e.push(l);for(g=[],f=[],m=["left","top","right","bottom"],g.push(this.getClass("abutted")),s=0,w=m.length;w>s;s++)l=m[s],g.push(""+this.getClass("abutted")+"-"+l);for(e.length&&f.push(this.getClass("abutted")),t=0,x=e.length;x>t;t++)l=e[t],f.push(""+this.getClass("abutted")+"-"+l);return a(function(){return c(D.target,f,g),c(D.element,f,g)}),!0}})}.call(this),function(){this.Tether.modules.push({position:function(a){var b,c,d,e,f,g,h;return g=a.top,b=a.left,this.options.shift?(c=function(a){return"function"==typeof a?a.call(this,{top:g,left:b}):a},d=c(this.options.shift),"string"==typeof d?(d=d.split(" "),d[1]||(d[1]=d[0]),f=d[0],e=d[1],f=parseFloat(f,10),e=parseFloat(e,10)):(h=[d.top,d.left],f=h[0],e=h[1]),g+=f,b+=e,{top:g,left:b}):void 0}})}.call(this),this.Tether}),function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=function(a,b){return function(){return a.apply(b,arguments)}},q={}.hasOwnProperty,r=function(a,b){function c(){this.constructor=a}for(var d in b)q.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};o=Tether.Utils,h=o.extend,m=o.removeClass,f=o.addClass,j=o.hasClass,b=o.Evented,i=o.getBounds,n=o.uniqueId,c=new b,a={top:"bottom center",left:"middle right",right:"middle left",bottom:"top center",center:"middle center"},g=function(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.children[0]},k=function(a,b){var c,d,e,f,g,h;return c=null!=(d=null!=(e=null!=(f=null!=(g=null!=(h=a.matches)?h:a.matchesSelector)?g:a.msMatchesSelector)?f:a.webkitMatchesSelector)?e:a.mozMatchesSelector)?d:a.oMatchesSelector,c.call(a,b)},l=function(a,b){var c,d,e,f,g,h;if(null==a)return a;if("object"==typeof a)return a;for(f=a.split(" "),f.length>b.length&&(f[0]=f.slice(0,+(f.length-b.length)+1||9e9).join(" "),f.splice(1,f.length-b.length)),d={},c=g=0,h=b.length;h>g;c=++g)e=b[c],d[e]=f[c];return d},d=function(b){function c(a,b){this.tour=a,this.destroy=p(this.destroy,this),this.scrollTo=p(this.scrollTo,this),this.complete=p(this.complete,this),this.cancel=p(this.cancel,this),this.isOpen=p(this.isOpen,this),this.hide=p(this.hide,this),this.show=p(this.show,this),this.setOptions(b)}return r(c,b),c.prototype.setOptions=function(a){var b,c,d,e;if(this.options=null!=a?a:{},this.destroy(),this.id=this.options.id||this.id||"step-"+n(),this.options.when){e=this.options.when;for(b in e)c=e[b],this.on(b,c,this)}return null!=(d=this.options).buttons?(d=this.options).buttons:d.buttons=[{text:"Next",action:this.tour.next}]},c.prototype.getTour=function(){return this.tour},c.prototype.bindAdvance=function(){var a,b,c,d,e=this;return d=l(this.options.advanceOn,["selector","event"]),a=d.event,c=d.selector,b=function(a){if(e.isOpen())if(null!=c){if(k(a.target,c))return e.tour.next()}else if(e.el&&a.target===e.el)return e.tour.next()},document.body.addEventListener(a,b),this.on("destroy",function(){return document.body.removeEventListener(a,b)})},c.prototype.getAttachTo=function(){var a;if(a=l(this.options.attachTo,["element","on"]),null==a&&(a={}),"string"==typeof a.element&&(a.element=document.querySelector(a.element),null==a.element))throw new Error("Shepherd step's attachTo was not found in the page");return a},c.prototype.setupTether=function(){var b,c,d;if("undefined"==typeof Tether||null===Tether)throw new Error("Using the attachment feature of Shepherd requires the Tether library");return c=this.getAttachTo(),b=a[c.on||"right"],null==c.element&&(c.element="viewport",b="middle center"),d={classPrefix:"shepherd",element:this.el,constraints:[{to:"window",pin:!0,attachment:"together"}],target:c.element,offset:c.offset||"0 0",attachment:b},this.tether=new Tether(h(d,this.options.tetherOptions))},c.prototype.show=function(){var a=this;return this.trigger("before-show"),null==this.el&&this.render(),f(this.el,"shepherd-open"),document.body.setAttribute("data-shepherd-step",this.id),this.setupTether(),this.options.scrollTo&&setTimeout(function(){return a.scrollTo()}),this.trigger("show")},c.prototype.hide=function(){var a;return this.trigger("before-hide"),m(this.el,"shepherd-open"),document.body.removeAttribute("data-shepherd-step"),null!=(a=this.tether)&&a.destroy(),this.tether=null,this.trigger("hide")},c.prototype.isOpen=function(){return j(this.el,"shepherd-open")},c.prototype.cancel=function(){return this.tour.cancel(),this.trigger("cancel")},c.prototype.complete=function(){return this.tour.complete(),this.trigger("complete")},c.prototype.scrollTo=function(){var a;return a=this.getAttachTo().element,null!=this.options.scrollToHandler?this.options.scrollToHandler(a):null!=a?a.scrollIntoView():void 0},c.prototype.destroy=function(){var a;return null!=this.el&&(document.body.removeChild(this.el),delete this.el),null!=(a=this.tether)&&a.destroy(),this.tether=null,this.trigger("destroy")},c.prototype.render=function(){var a,b,c,d,e,f,h,i,j,k,l,m,n,o,p,q,r;if(null!=this.el&&this.destroy(),this.el=g("<div class='shepherd-step "+(null!=(p=this.options.classes)?p:"")+"' data-id='"+this.id+"'></div>"),d=document.createElement("div"),d.className="shepherd-content",this.el.appendChild(d),f=document.createElement("header"),d.appendChild(f),null!=this.options.title&&(f.innerHTML+="<h3 class='shepherd-title'>"+this.options.title+"</h3>",this.el.className+=" shepherd-has-title"),this.options.showCancelLink&&(h=g("<a href class='shepherd-cancel-link'>✕</a>"),f.appendChild(h),this.el.className+=" shepherd-has-cancel-link",this.bindCancelLink(h)),null!=this.options.text){if(k=g("<div class='shepherd-text'></div>"),j=this.options.text,"function"==typeof j&&(j=this.options.text.call(this,k)),j instanceof HTMLElement)k.appendChild(j);else for("string"==typeof j&&(j=[j]),l=0,n=j.length;n>l;l++)i=j[l],k.innerHTML+="<p>"+i+"</p>";d.appendChild(k)}if(e=document.createElement("footer"),this.options.buttons){for(b=g("<ul class='shepherd-buttons'></ul>"),q=this.options.buttons,m=0,o=q.length;o>m;m++)c=q[m],a=g("<li><a class='shepherd-button "+(null!=(r=c.classes)?r:"")+"'>"+c.text+"</a>"),b.appendChild(a),this.bindButtonEvents(c,a.querySelector("a"));e.appendChild(b)}return d.appendChild(e),document.body.appendChild(this.el),this.setupTether(),this.options.advanceOn?this.bindAdvance():void 0},c.prototype.bindCancelLink=function(a){var b=this;return a.addEventListener("click",function(a){return a.preventDefault(),b.cancel()})},c.prototype.bindButtonEvents=function(a,b){var c,d,e,f,g=this;null==a.events&&(a.events={}),null!=a.action&&(a.events.click=a.action),f=a.events;for(c in f)d=f[c],"string"==typeof d&&(e=d,d=function(){return g.tour.show(e)}),b.addEventListener(c,d);return this.on("destroy",function(){var e,f;e=a.events,f=[];for(c in e)d=e[c],f.push(b.removeEventListener(c,d));return f})},c}(b),e=function(a){function b(a){var b,d,e,f,g,h,i=this;for(this.options=null!=a?a:{},this.hide=p(this.hide,this),this.complete=p(this.complete,this),this.cancel=p(this.cancel,this),this.back=p(this.back,this),this.next=p(this.next,this),this.steps=null!=(g=this.options.steps)?g:[],h=["complete","cancel","hide","start","show","active","inactive"],d=function(a){return i.on(a,function(b){return null==b&&(b={}),b.tour=i,c.trigger(a,b)})},e=0,f=h.length;f>e;e++)b=h[e],d(b)}return r(b,a),b.prototype.addStep=function(a,b){var c;return null==b&&(b=a),b instanceof d?b.tour=this:(("string"==(c=typeof a)||"number"===c)&&(b.id=a.toString()),b=h({},this.options.defaults,b),b=new d(this,b)),this.steps.push(b),this},b.prototype.getById=function(a){var b,c,d,e;for(e=this.steps,c=0,d=e.length;d>c;c++)if(b=e[c],b.id===a)return b},b.prototype.getCurrentStep=function(){return this.currentStep},b.prototype.next=function(){var a;return a=this.steps.indexOf(this.currentStep),a===this.steps.length-1?(this.hide(a),this.trigger("complete"),this.done()):this.show(a+1)},b.prototype.back=function(){var a;return a=this.steps.indexOf(this.currentStep),this.show(a-1)},b.prototype.cancel=function(){var a;return null!=(a=this.currentStep)&&a.hide(),this.trigger("cancel"),this.done()},b.prototype.complete=function(){var a;return null!=(a=this.currentStep)&&a.hide(),this.trigger("complete"),this.done()},b.prototype.hide=function(){var a;return null!=(a=this.currentStep)&&a.hide(),this.trigger("hide"),this.done()},b.prototype.done=function(){return c.activeTour=null,m(document.body,"shepherd-active"),this.trigger("inactive",{tour:this})},b.prototype.show=function(a){var b;return null==a&&(a=0),this.currentStep?this.currentStep.hide():(f(document.body,"shepherd-active"),this.trigger("active",{tour:this})),c.activeTour=this,b="string"==typeof a?this.getById(a):this.steps[a],b?(this.trigger("show",{step:b,previous:this.currentStep}),this.currentStep=b,b.show()):void 0},b.prototype.start=function(){return this.trigger("start"),this.currentStep=null,this.next()},b}(b),h(c,{Tour:e,Step:d,Evented:b}),window.Shepherd=c}.call(this),!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c;return void 0!==e[b]?b:void 0}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.width,left:d.radius,top:-d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.length+d.width,k=2*j,l=2*-(d.width+d.length)+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)
},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=e(a(0,{className:d.className}),{position:d.position,width:0,zIndex:d.zIndex});if(d.radius+d.length+d.width,e(f,{left:d.left,top:d.top}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function o(){h++;for(var a=0;a<d.lines;a++)g=Math.max(1-(h+(d.lines-a)*n)%l*m,d.opacity),c.opacity(f,a*d.direction+i,g,d);c.timeout=c.el&&setTimeout(o,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h});