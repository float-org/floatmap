  {% extends "base.html" %}
{% load static from staticfiles %}
 {% block extra_css %}
  <script src='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.js'></script>
  <link href='https://api.tiles.mapbox.com/mapbox.js/v2.1.5/mapbox.css' rel='stylesheet' />
  <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css' />
  <link rel="stylesheet" href="{{STATIC_URL}}css/floatmap.css">
 {% endblock %}
 {% block content %}
  <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

      <script id="headerTemplate" type="template">          
        <div class="row clearfix">
          <div class="logo col-md-3">
              <h1><a href="/">FLOAT</a></h1>
          </div>

          <form action="#" method="POST" id="search" class="col-md-7">
              <input type="text" class="search-input">
              <button>Search</button>
          </form>

          <nav class="col-md-2">
              <a href="#about" data-toggle="modal" data-target="#aboutModal">About</a>
              <a id="tourLink" href="#tour">Tour</a>
          </nav>
        </div>
      </script>

      <script id="mapTemplate" type="template"></script>

      <script id="legendTemplate" type="template">   
            <div id="query"></div>
            <div class='legend-panel col-md-4'>
              <div id="apLegendContainer">
                <h3>Annual Precipitation</h3>
                <span class="glyphicon glyphicon-question-sign" data-toggle='tooltip' title='Increase in the average amount of precipitation each year in 2040-2070, relative to the present. (NOAA 2014)'></span>
                <div class="onoffswitch">
                  <input type="checkbox" name="apLayer-switch" class="onoffswitch-checkbox" data-layer="apLayer" id="apLayer-switch">
                  <label class="onoffswitch-label" for="apLayer-switch">
                    <span class="onoffswitch-inner"></span><span class="onoffswitch-switch"></span>
                  </label>
                </div>    
              </div>

              <div id="epLegendContainer">
                <h3>Storm Frequency</h3>
                <span class="glyphicon glyphicon-question-sign" data-toggle='tooltip' title='Increase in the average number of days with precipitation greater than 1 inch each year in 2040-2070, relative to the present. (NOAA 2014)'></span>
                <div class="onoffswitch">
                  <input type="checkbox" name="epLayer-switch" class="onoffswitch-checkbox" data-layer="epLayer" id="epLayer-switch">
                  <label class="onoffswitch-label" for="epLayer-switch">
                    <span class="onoffswitch-inner"></span><span class="onoffswitch-switch"></span>
                  </label>
                </div>   
              </div>

              <div id="floodsLegendContainer">
                <h3>Flood Zones</h3>
                <span class="glyphicon glyphicon-question-sign" data-toggle='tooltip' title='Areas with a serious risk of flooding even without climate change, based on historical record and topography. (FEMA 2014)'></span>
                <div class="onoffswitch">
                  <input type="checkbox" name="floods-switch" class="onoffswitch-checkbox" data-layer="floods" id="floods-switch" >
                  <label class="onoffswitch-label" for="floods-switch">
                    <span class="onoffswitch-inner"></span><span class="onoffswitch-switch"></span>
                  </label>
                </div>  
              </div>

            </div>

            <div class='legend-data col-md-8'>

              <div class='apRange'></div>

              <div class='epRange'>
                <svg width="325" height"70">
                  <rect x="0" y="0" width="81" height="32" class="low-mid dots"></rect>
                  <rect x="81" y="0" width="81" height="32" class="mid-high dots"></rect>
                  <rect x="162" y="0" width="81" height="32" class="high-extreme dots"></rect>
                  <rect x="243" y="0" width="81" height="32" class="extreme-severe dots"></rect>
                  <defs>
                  <marker id="arrow" viewBox="0 -5 10 10" refX="10" refY="0" markerWidth="10" markerHeight="10" orient="auto"><path d="M0,-5L10,0L0,5"></path></marker>
                  </defs>
                  <line x1="0" y1="55" x2="325" y2="55" class="link arrow" marker-end="url(#arrow)"></line>
                  <text x="94" y="67">Increasing storm frequency</text>
                  <text x="3" y="45">+12%</text>
                  <text x="95" y="45">+26%</text>
                  <text x="196" y="45">+40%</text>
                  <text x="297" y="45">+54%</text>
                </svg>
              </div>
           
              <ul class='floodRange'>
                <li class="year-500">
                  <div></div>
                  <span>High</span>
                </li>
                <li class="year-100">
                  <div></div>
                  <span>Extreme</span>
                </li>
              </ul>
                    
            </div>       
      </script>

      <script id="queryTemplate" type="template">
        <div id="queryContent" class="well">
          <div id="queryToggle">
            <span class="glyphicon glyphicon-eject"></span>
          </div>
          <ul class="metrics">
            <li><label>Annual Precipitation:</label><span><%= query.ap %></span><a href='#'>source</a></li>
            <li><label>Storm Frequency:</label><span>25% Increase</span><a href='#'>source</a></li>
            <li><label>Flood Hazard Zone:</label> <span>Extreme</span> <a href='#'>source</a></li>
          </ul>
          <p>This address has a high risk of of more floods due to climate change</p>
        </div>
      </script>

      <script id="welcomeTemplate" type="template">
        <div class="modal fade" id="welcomeModal" tabindex="-" role="dialog" aria-labelledby="welcomeModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h1>Welcome to Float</h1>
              </div>
              <div class="modal-body">
                <p>Float shows the projected impacts of climate chaos on American communities in the 2040-2070 period.</p>

                <p>Float currently shows how key risk factors for flooding are projected to worsen in the Midwest US.</p>
  
                <p>If you see areas without one of the data layers, that doesn’t mean those places are risk free--it just means the science hasn’t got there yet. We show only projections where a large majority of studies agree.</p>
              </div>
              <div class="modal-footer">
                <a id="startDataTour" class="btn btn-primary" href="#">Continue</a>
                <button id="closeModal" type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
      </script>

      <script id="floatLayout" type="layout">
          <header id="header"></header>
          <div id="map"></div>
          <div id="legend"></div>
          <div id="welcome"></div>
      </script>

       <div class="modal fade" id="aboutModal" tabindex="-" role="dialog" aria-labelledby="aboutModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3 class="modal-title">About Float</h4>
              </div>
              <div class="modal-body" id="accordion">
                  <div class="panel">
                  <h2>
                   <a data-toggle="collapse" data-parent="#accordion" href="#overview" aria-expanded="true" aria-controls="overview">
                    Overview
                  </a>
                  </h2>

                  <div id="overview" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="overview">
                    <p>Float Map shows the projected impacts of unchecked climate change on American homes, businesses, and communities.</p>
                    <p>Float Map shows projections of the 2040-2070 time period, if the current path continues with no serious reductions in climate pollution.</p>
                    <p>Float Map currently shows projections related to worsening flooding in the Midwest US. We working to expand to other projections and other regions of the United States.</p>
                    <p>We use data only from the most recent available NOAA and FEMA research, and we always share our sources. </p>
                    <p>Float is an independent, non-partisan, not-for-profit organization. Float received the Judges’ Choice and Popular Choice awards in the MIT Climate Colab competition.</p>
                    <p>Please feel free to send questions and your feedback on how to make Float better: info@floatmap.us</p>
                  </div>
                  
                  <h2>
                  <a data-toggle="collapse" data-parent="#accordion" href="#dataSources" aria-expanded="true" aria-controls="dataSources">
                    Data Sources
                  </a>
                  </h2>
                  <div id="dataSources" class="panel-collapse collapse" role="tabpanel" aria-labelledby="dataSources">
                    <p>The Average Precipitation layer shows how total rain and snowfall each year is projected to grow by the 2040-2070 period. More annual precipitation means more water going into rivers, lakes and snowbanks, a key risk factor for bigger floods. The Average Precipitation layer uses data from the National Oceanic and Atmospheric Administration’s “Regional Climate Trends and Scenarios for the U.S. National Climate Assessment” (Technical Report 142, 2014, link). This layer shows the percent change between high-emissions scenario (A2) projections of the 2040-2070 time period, versus the historical climate data from 1971-1999. The data presented on Float is a multi-model average of the results from 15 distinct climate models (Atmosphere-Ocean General Circulation Models), compiled in the Coupled Model Intercomparison Project phase 3 dataset. The Float average precipitation layer uses only the NOAA data where a majority of the models show statistically significant change, and over 67% of the models agree on the direction of the change, which is the highest category of data significance which NOAA distinguishes in this report. This data is visualized in the NOAA report for the Midwest (142-3) in Section 3.7, Figure 40, center left.</p>

                    <p>The Storm Frequency layer uses shows how days with heavy rain or snow (over 1 inch per day) are projected to come more often, by the 2040-2070 period. More storm frequency means more rapid surges of water into rivers and lakes, a key risk factor for more frequent flooding. The Storm Frequency layer uses data from the National Oceanic and Atmospheric Administration’s “Regional Climate Trends and Scenarios for the U.S. National Climate Assessment” (Technical Report 142, 2014, link). This layer shows the percent change between high-emissions scenario (A2) projections of the 2040-2070 time period, versus the historical climate data from 1980-2000. The data presented on Float is a multi-model average of the results from 11 distinct climate models compiled in the North American Regional Climate Change Assessment Program dataset. The Float storm frequency layer uses only the NOAA data where a majority of the models show statistically significant change, and over 67% of the models agree on the direction of the change, which is the highest category of data significance which NOAA distinguishes in this report. This data is visualized in the NOAA report for the Midwest (142-3) in Section 3.9, Figure 44, top.</p>

                    <p>The Flood Zones layer shows the areas that already are at major risk for flooding, based on where floods have historically reached. If floods become larger and more frequent, many neighboring areas to these historical flood zones are likely to start experience flooding. The Flood Zones layer uses the Special Flood Hazard Areas data from the Federal Emergency Management Administration (FEMA) Flood Maps. The layer shows the areas currently judged to be at significant risk of flooding, based on statistical analysis of river flow records, consultation with community members, extensive topographic surveys, hydrologic analyses, hydraulic analyses, and analyses of historical storm tides and rainfall. The FEMA Flood Maps are the official data used in support of the National Flood Insurance Program, and are updated on an ongoing basis. Public access to the FEMA Flood maps is available through the FEMA Map Service Center (link).</p>

                    <p>We selected the data layers used for Float after consultation with experts at Lawrence Berkeley National Laboratory, the National Center for Atmospheric Research, and the National Climate Data Center. All of these organization are public, not-for-profit research institutions.</p>

                    <p>Float was constructed using a combination of different tools, including Django, Elasticsearch, BackboneJS, Leaflet, and Mapbox Studio.  Check out the source, and stay up to date with our current development on <a href="https://github.com/float-org/floatmap/">Github.</a></p>
                  </div>

                  <h2>
                  <a data-toggle="collapse" data-parent="#accordion" href="#team" aria-expanded="true" aria-controls="team">
                  About Our Team
                  </a>
                  </h2>

                  <div id="team" class="panel-collapse collapse" role="tabpanel" aria-labelledby="dataSources">
                    <p>Float is an independent, not-for-profit organization.</p>

                    <h3>Keith Brower Brown</h3>
                    <p>Growing up in Oregon, with family on an apple orchard and summers on Cascade trails,  Keith became passionate for protecting how communities depend on their land and climate. After studying Environmental Economics and Geography at UC Berkeley, Keith worked in the energy industry at PG&E and Navigant Consulting, before founding Float in 2013.</p> 

                    <h3>Mike Vattuone</h3>
                    <p>A former developer at Citizen Engagement Laboratory, Mike has worked on a number of climate related campaigns for a number of advocacy groups.  With a background in cognitive science and user experience research, Mike has a unique interest in both modular software architecture and user interface design.</p>

                    <h3>Matteo Banerjee</h3>
                    <h3>Max Gardner</h3>
                  </div>

                  <h2>
                    <a data-toggle="collapse" data-parent="#accordion" href="#contact" aria-expanded="true" aria-controls="contact">
                      Contact Us
                    </a>
                  </h2>

                  <div id="contact" class="panel-collapse collapse" role="tabpanel" aria-labelledby="contact">
                    <p>Please feel free to send questions and your feedback on how to make Float better: <br />
                       <a href="mailto:info@floatmap.us">info@floatmap.us</a></p>
                  </div>
                </div>
                </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              </div>
            </div><!-- /.modal-content -->
          </div><!-- /.modal-dialog -->
        </div><!-- /.modal -->
  {%endblock%}

  
  {% block extra_js %} 
  <script>
    window.epData = $.parseJSON({{epData|safe}});
    window.apData = $.parseJSON({{apData|safe}});
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
  <script src="{{STATIC_URL}}js/floatmap.js"></script>
  {% endblock %}